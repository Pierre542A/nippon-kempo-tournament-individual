import{h as k,a as x,e as f,f as _,d as m}from"./QSelect-BQUXwyF1.js";import{Y as Ie,Z as Le,r as g,b as A,V as De,J as Pe,ak as Re,_ as b,$ as t,a1 as s,a0 as l,a5 as h,a3 as i,a4 as r,ae as O,ad as V,ao as re,a2 as w,aq as de,a6 as J,ap as Ne,ai as je,aa as K,ab as Q,K as D,ag as ue,a9 as Y,ac as Fe,ah as me,aw as Se,al as p}from"./index-DRsz5w2d.js";import{Q as Me}from"./QBanner-DIkF7s1T.js";import{Q as T,a as ze,b as q,c as Oe}from"./QTable-CR_Qw671.js";import{Q as ce}from"./QTr-Bc9BNqo7.js";import{Q as fe}from"./QImg-Bpmswd2f.js";import{Q as Z}from"./QTooltip-BeCuxwp4.js";import{Q as Be}from"./QList-Myhhz7id.js";import{Q as Ge}from"./QForm-Cx9K0l2g.js";import{Q as He}from"./QPage-D-rMEcpj.js";import{C as P}from"./ClosePopup-D3O_dCn1.js";import{u as Je}from"./use-quasar-BkUvSKY7.js";const Ke={class:"q-pa-md"},Ye={class:"row items-center q-mb-md"},Ze={class:"row q-gutter-sm"},We={class:"row q-col-gutter-md q-mb-md"},Xe={class:"col-12 col-md-3"},el={class:"col-12 col-md-3"},ll={class:"col-12 col-md-3"},tl={class:"col-12 col-md-3"},al={class:"row items-center"},ol={class:"row items-center q-gutter-x-sm"},il={class:"row q-gutter-xs justify-center"},nl={class:"full-width row flex-center text-grey q-gutter-sm q-pa-lg"},sl={class:"row justify-center q-mb-md"},rl={class:"text-h6"},dl={class:"q-mb-md"},ul={class:"row q-col-gutter-md"},ml={class:"col-12 col-md-6"},cl={class:"col-12 col-md-6"},fl={class:"row q-col-gutter-md q-mt-sm"},_l={class:"col-12 col-md-6"},vl={class:"col-12 col-md-6"},gl={class:"row q-col-gutter-md q-mt-sm"},pl={class:"col-12 col-md-6"},bl={class:"col-12 col-md-6"},wl={class:"q-mb-md"},yl={class:"row q-col-gutter-md"},hl={class:"col-12 col-md-6"},Vl={class:"col-12 col-md-6"},Ul={class:"row q-col-gutter-md q-mt-sm"},kl={class:"col-12 col-md-4"},xl={class:"col-12 col-md-4"},Al={class:"col-12 col-md-4"},ql={class:"q-mb-md"},Cl={class:"row q-col-gutter-md"},El={class:"col-12 col-md-6"},Ql={class:"col-12 col-md-6 flex items-center"},Tl={class:"row justify-end q-mt-lg"},$l={class:"text-h6"},Il={key:0},Ll={key:1,class:"text-caption text-grey-8"},Jl=Ie({__name:"AdminPage",setup(Dl){const U=Je(),_e=Re(),W=Le(),y=g([]),C=g(!1),$=g(!1),B=g(!1),I=g(""),E=g(""),R=g(null),N=g(null),j=g(!1),F=g(!1),S=g(!1),c=g(null),v=g(null),X=[{label:"Administrateur",value:1},{label:"Manager",value:2},{label:"Joueur",value:3}],ee=[{label:"Homme",value:1},{label:"Femme",value:2}],ve=[{label:"Actif",value:!0},{label:"Inactif",value:!1}],G=g([]),M=g(null),L=g([]),ge=A(()=>o=>{if(!o)return"—";const e=L.value.find(a=>a.id===o);return e?e.name:"—"});async function pe(){try{const e=await fetch("undefined/clubs",{credentials:"include"});if(!e.ok)throw new Error(`Erreur HTTP clubs: ${e.status}`);const a=await e.json();if(!Array.isArray(a.clubs))return;G.value=[],G.value=a.clubs.map(d=>({id:d.id,name:d.name}))}catch(o){console.error("Erreur fetchClubs:",o)}}async function be(){try{const e=await fetch("undefined/grades",{credentials:"include"});if(!e.ok)throw new Error(`Erreur HTTP grades: ${e.status}`);const a=await e.json();if(!Array.isArray(a.grades)){console.error("Réponse grades inattendue:",a);return}L.value=[],L.value=a.grades.map(d=>({id:d.id,name:d.name}))}catch(o){console.error("Erreur fetchGrades:",o)}}const le=A(()=>G.value.map(o=>({label:o.name,value:o.id}))),we=A(()=>L.value.map(o=>({label:o.name,value:o.id}))),ye=A(()=>y.value.filter(o=>o.id_role===1).length),he=A(()=>y.value.filter(o=>o.id_role===2).length),Ve=A(()=>y.value.filter(o=>o.id_role===3).length),n=De({id:null,first_name:"",last_name:"",email:"",phone:"",birth_date:"",id_role:3,id_gender:1,weight:null,nationality:"Française",id_club:null,id_tournament_waiting:null,is_active:!0,avatar_seed:null,id_grade:null}),Ue=[{name:"id",label:"ID",field:"id",sortable:!0,align:"left"},{name:"name",label:"Nom",field:o=>`${o.first_name} ${o.last_name}`,sortable:!0,align:"left"},{name:"email",label:"Email",field:"email",sortable:!0,align:"left"},{name:"role",label:"Rôle",field:"id_role",sortable:!0,align:"center"},{name:"info",label:"Informations",field:"info",sortable:!1,align:"left"},{name:"status",label:"Statut",field:"is_active",sortable:!0,align:"center"},{name:"actions",label:"Actions",field:"actions",sortable:!1,align:"center"}],ke=A(()=>y.value.filter(o=>{const e=!E.value||o.first_name.toLowerCase().includes(E.value.toLowerCase())||o.last_name.toLowerCase().includes(E.value.toLowerCase())||o.email.toLowerCase().includes(E.value.toLowerCase()),a=R.value===null||o.id_role===R.value,d=N.value===null||!!o.is_active==!!N.value,u=M.value===null||o.id_club===M.value;return e&&a&&d&&u})),te=o=>({1:"Admin",2:"Manager",3:"Joueur"})[o]||"Inconnu",z=o=>({1:"purple",2:"blue",3:"green"})[o]||"grey",ae=o=>o?new Date(o).toLocaleDateString("fr-FR"):"—",oe=o=>`https://api.dicebear.com/6.x/avataaars/svg?seed=${o}&size=64`,xe=(o,e,a)=>`${o} à ${e} sur ${a}`;async function H(){C.value=!0,I.value="";try{const e=await fetch("undefined/admin/users",{credentials:"include"});if(!e.ok)throw new Error(`Erreur HTTP: ${e.status}`);const a=await e.json();if(!Array.isArray(a.users))throw new Error("Format de réponse incorrect");y.value=a.users.map(d=>({...d,id_grade:d.id_grade||null,is_active:typeof d.is_active=="boolean"?d.is_active:d.is_active===1||d.is_active==="true"}))}catch(o){console.error(o),I.value=o instanceof Error?o.message:String(o)}finally{C.value=!1}}async function Ae(o){try{const a=await fetch(`undefined/users/${o.id}`,{credentials:"include"});if(!a.ok)throw new Error(`Erreur HTTP: ${a.status}`);const d=await a.json();if(!d.user)throw new Error("Format de réponse incorrect");const u=d.user;let ne=u.grade_name;if(u.id_grade&&!u.grade_name){const se=L.value.find($e=>$e.id===u.id_grade);se&&(ne=se.name)}c.value={...u,id:u.id||0,first_name:u.first_name||"",last_name:u.last_name||"",email:u.email||"",phone:u.phone||"",birth_date:qe(u.birth_date)||"",id_role:u.id_role||0,id_gender:u.id_gender||0,weight:u.weight||null,nationality:u.nationality||"",id_club:u.id_club||null,club_name:u.club_name||null,id_grade:u.id_grade||null,grade_name:ne||null,id_tournament_waiting:u.id_tournament_waiting||null,tournament_name:u.tournament_name||null,is_active:!!u.is_active,avatar_seed:u.avatar_seed||"default",created_at:u.created_at||new Date().toISOString()},F.value=!0}catch(e){console.error("Erreur lors de la récupération des détails:",e),U.notify({color:"negative",message:e instanceof Error?e.message:"Erreur lors de la récupération des détails",icon:"error"})}}function qe(o){if(!o)return null;try{return o.includes(" ")||o.includes("T")?o.split(/[ T]/)[0]||null:o}catch(e){return console.error("Erreur lors du formatage de la date:",e),o}}const Ce=o=>{if(!o)return"—";try{const e=new Date(o);return isNaN(e.getTime())?"—":e.toLocaleString("fr-FR")}catch(e){return console.error("Erreur lors du formatage de la date de création:",e),"—"}};function ie(o){Object.assign(n,{id:null,first_name:"",last_name:"",email:"",phone:"",birth_date:"",id_role:3,id_gender:1,weight:null,nationality:"Française",id_club:null,id_tournament_waiting:null,is_active:!0,avatar_seed:null,id_grade:null}),Object.assign(n,{id:o.id,first_name:o.first_name||"",last_name:o.last_name||"",email:o.email||"",phone:o.phone||"",birth_date:o.birth_date?o.birth_date.split("T")[0]:"",id_role:o.id_role!==void 0?Number(o.id_role):3,id_gender:o.id_gender!==void 0?Number(o.id_gender):1,weight:o.weight!==void 0&&o.weight!==null?Number(o.weight):null,nationality:o.nationality||"Française",id_club:o.id_club!==void 0&&o.id_club!==null?Number(o.id_club):null,id_tournament_waiting:o.id_tournament_waiting,is_active:typeof o.is_active=="boolean"?o.is_active:!0,avatar_seed:o.avatar_seed||"default",id_grade:o.id_grade!==void 0&&o.id_grade!==null?Number(o.id_grade):null}),j.value=!0}function Ee(o){v.value={...o},S.value=!0}async function Qe(){if(v.value){B.value=!0;try{const e=await fetch(`undefined/users/${v.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({is_active:!v.value.is_active})});if(!e.ok){const d=await e.json();throw new Error(d.error||`Erreur HTTP: ${e.status}`)}const a=y.value.findIndex(d=>d.id===v.value?.id);a!==-1&&v.value&&(y.value[a].is_active=!v.value.is_active),await H(),U.notify({color:"positive",message:`Utilisateur ${v.value.is_active?"désactivé":"activé"} avec succès`,icon:"check_circle"}),S.value=!1}catch(o){console.error("Erreur lors de la mise à jour du statut:",o),U.notify({color:"negative",message:o instanceof Error?o.message:"Erreur lors de la mise à jour du statut",icon:"error"})}finally{B.value=!1}}}async function Te(){$.value=!0;try{if(!n.first_name||!n.last_name||!n.email){U.notify({color:"negative",message:"Veuillez remplir tous les champs obligatoires",icon:"warning"}),$.value=!1;return}if(!/^[^@]+@[^@]+\.[^@]+$/.test(n.email)){U.notify({color:"negative",message:"Format d'email invalide",icon:"warning"}),$.value=!1;return}const o=y.value.find(u=>u.id===n.id),e={first_name:n.first_name,last_name:n.last_name,email:n.email,phone:n.phone===""?null:n.phone,birth_date:n.birth_date||void 0,id_role:n.id_role,id_gender:n.id_gender||(o?o.id_gender:1),weight:n.weight===null||n.weight===void 0?o?o.weight:null:n.weight,nationality:n.nationality||"",id_club:n.id_club,is_active:n.is_active,avatar_seed:n.avatar_seed||"default",id_grade:n.id_grade},d=await fetch(`undefined/users/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!d.ok){const u=await d.json();throw new Error(u.error||`Erreur HTTP: ${d.status}`)}await H(),U.notify({color:"positive",message:"Utilisateur mis à jour avec succès",icon:"check_circle"}),j.value=!1}catch(o){console.error("Erreur lors de la sauvegarde:",o);let e="Erreur lors de la sauvegarde";o instanceof Error&&(o.message.includes("email")?e="Cet email est déjà utilisé par un autre compte":e=o.message),U.notify({color:"negative",message:e,icon:"error"})}finally{$.value=!1}}return Pe(async()=>{if(!W.user||W.user.id_role!==1){U.notify({color:"negative",message:"Accès restreint aux administrateurs",timeout:5e3}),_e.push("/");return}C.value=!0;try{await pe(),await be(),await H()}catch(o){console.error("Erreur lors du chargement des données:",o),I.value="Erreur lors du chargement des données"}finally{C.value=!1}}),(o,e)=>(p(),b(He,{padding:""},{default:t(()=>[s("div",Ke,[e[25]||(e[25]=s("h1",{class:"text-h4 q-mb-md"},"Gestion des utilisateurs",-1)),s("div",Ye,[s("div",Ze,[y.value.length?(p(),b(k,{key:0,color:"primary","text-color":"white"},{default:t(()=>[i(" Total : "+r(y.value.length),1)]),_:1})):h("",!0),l(k,{color:"purple","text-color":"white"},{default:t(()=>[i(" Admins : "+r(ye.value),1)]),_:1}),l(k,{color:"blue","text-color":"white"},{default:t(()=>[i(" Managers : "+r(he.value),1)]),_:1}),l(k,{color:"green","text-color":"white"},{default:t(()=>[i(" Joueurs : "+r(Ve.value),1)]),_:1})])]),I.value?(p(),b(Me,{key:0,class:"bg-negative text-white q-mb-md"},{avatar:t(()=>[l(O,{name:"error"})]),default:t(()=>[i(" "+r(I.value),1)]),_:1})):h("",!0),s("div",We,[s("div",Xe,[l(V,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=a=>E.value=a),outlined:"",dense:"",label:"Rechercher par nom",clearable:""},{append:t(()=>[l(O,{name:"search"})]),_:1},8,["modelValue"])]),s("div",el,[l(x,{modelValue:M.value,"onUpdate:modelValue":e[1]||(e[1]=a=>M.value=a),options:le.value,label:"Filtrer par club",outlined:"",dense:"","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"])]),s("div",ll,[l(x,{modelValue:R.value,"onUpdate:modelValue":e[2]||(e[2]=a=>R.value=a),options:X,outlined:"",dense:"",label:"Filtrer par rôle","emit-value":"","map-options":"",clearable:""},{"selected-item":t(({opt:a})=>[l(T,{color:z(a.value)},{default:t(()=>[i(r(a.label),1)]),_:2},1032,["color"])]),_:1},8,["modelValue"])]),s("div",tl,[l(x,{modelValue:N.value,"onUpdate:modelValue":e[3]||(e[3]=a=>N.value=a),options:ve,outlined:"",dense:"",label:"Statut","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])])]),C.value?h("",!0):(p(),b(ze,{key:1,rows:ke.value,columns:Ue,"row-key":"id",loading:C.value,bordered:"",flat:"","pagination-label":xe,"rows-per-page-options":[10,15,20,0]},{header:t(a=>[l(ce,{props:a},{default:t(()=>[(p(!0),J(je,null,Ne(a.cols,d=>(p(),b(Oe,{key:d.name,props:a},{default:t(()=>[i(r(d.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:t(a=>[l(ce,{props:a,class:de(a.row.is_active?"":"bg-grey-2")},{default:t(()=>[l(q,{key:"id",props:a},{default:t(()=>[i(r(a.row.id),1)]),_:2},1032,["props"]),l(q,{key:"name",props:a},{default:t(()=>[s("div",al,[l(re,{size:"28px",class:"q-mr-sm"},{default:t(()=>[a.row.avatar_seed?(p(),b(fe,{key:0,src:oe(a.row.avatar_seed)},null,8,["src"])):(p(),b(O,{key:1,name:"person",size:"28px",color:"grey-7"}))]),_:2},1024),i(" "+r(a.row.first_name)+" "+r(a.row.last_name),1)])]),_:2},1032,["props"]),l(q,{key:"email",props:a},{default:t(()=>[i(r(a.row.email),1)]),_:2},1032,["props"]),l(q,{key:"role",props:a},{default:t(()=>[l(T,{color:z(a.row.id_role)},{default:t(()=>[i(r(te(a.row.id_role)),1)]),_:2},1032,["color"])]),_:2},1032,["props"]),l(q,{key:"info",props:a},{default:t(()=>[s("div",ol,[l(k,{dense:"",outline:"",size:"sm",icon:"event"},{default:t(()=>[i(r(ae(a.row.birth_date)),1)]),_:2},1024),a.row.weight?(p(),b(k,{key:0,dense:"",outline:"",size:"sm",icon:"fitness_center"},{default:t(()=>[i(r(a.row.weight)+" kg ",1)]),_:2},1024)):h("",!0),l(k,{dense:"",size:"sm",icon:"flag"},{default:t(()=>[i(r(a.row.nationality),1)]),_:2},1024)])]),_:2},1032,["props"]),l(q,{key:"status",props:a},{default:t(()=>[l(T,{color:a.row.is_active?"positive":"negative"},{default:t(()=>[i(r(a.row.is_active?"Actif":"Inactif"),1)]),_:2},1032,["color"])]),_:2},1032,["props"]),l(q,{key:"actions",props:a,class:"q-gutter-sm"},{default:t(()=>[s("div",il,[l(w,{flat:"",dense:"",round:"",icon:"visibility",color:"primary",onClick:d=>Ae(a.row)},{default:t(()=>[l(Z,null,{default:t(()=>e[22]||(e[22]=[i("Voir détails")])),_:1})]),_:2},1032,["onClick"]),l(w,{flat:"",dense:"",round:"",icon:"edit",color:"info",onClick:d=>ie(a.row)},{default:t(()=>[l(Z,null,{default:t(()=>e[23]||(e[23]=[i("Modifier")])),_:1})]),_:2},1032,["onClick"]),l(w,{flat:"",dense:"",round:"",icon:a.row.is_active?"block":"restore",color:a.row.is_active?"negative":"positive",onClick:d=>Ee(a.row)},{default:t(()=>[l(Z,null,{default:t(()=>[i(r(a.row.is_active?"Désactiver":"Activer"),1)]),_:2},1024)]),_:2},1032,["icon","color","onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props","class"])]),"no-data":t(()=>[s("div",nl,[l(O,{size:"2em",name:"sentiment_dissatisfied"}),e[24]||(e[24]=s("span",null," Aucun utilisateur trouvé ",-1))])]),_:1},8,["rows","loading"]))]),l(Y,{modelValue:F.value,"onUpdate:modelValue":e[5]||(e[5]=a=>F.value=a)},{default:t(()=>[l(K,{style:{"min-width":"350px","max-width":"80vw"}},{default:t(()=>[l(Q,{class:"bg-primary text-white"},{default:t(()=>[e[26]||(e[26]=s("div",{class:"text-h6"},"Détails de l'utilisateur",-1)),D(l(w,{icon:"close",flat:"",round:"",dense:"",class:"absolute-right"},null,512),[[P]])]),_:1}),c.value?(p(),b(Q,{key:0},{default:t(()=>[s("div",sl,[l(re,{size:"80px"},{default:t(()=>[l(fe,{src:oe(c.value.avatar_seed||"default")},null,8,["src"])]),_:1})]),l(Be,{bordered:"",separator:""},{default:t(()=>[l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[27]||(e[27]=[i("ID")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.id),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[28]||(e[28]=[i("Nom complet")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.first_name)+" "+r(c.value.last_name),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[29]||(e[29]=[i("Email")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.email),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[30]||(e[30]=[i("Téléphone")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.phone||"—"),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[31]||(e[31]=[i("Date de naissance")])),_:1}),l(m,null,{default:t(()=>[i(r(ae(c.value.birth_date)),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[32]||(e[32]=[i("Rôle")])),_:1}),l(m,null,{default:t(()=>[l(T,{color:z(c.value.id_role)},{default:t(()=>[i(r(te(c.value.id_role)),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),c.value?(p(),b(f,{key:0},{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[33]||(e[33]=[i("Genre")])),_:1}),l(m,null,{default:t(()=>[i(r(ee.find(a=>a.value===c.value?.id_gender)?.label||"—"),1)]),_:1})]),_:1})]),_:1})):h("",!0),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[34]||(e[34]=[i("Poids")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.weight?c.value.weight+" kg":"—"),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[35]||(e[35]=[i("Nationalité")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.nationality||"—"),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[36]||(e[36]=[i("Club")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.club_name||"—"),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[37]||(e[37]=[i("Grade")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.grade_name||ge.value(c.value.id_grade)||"—"),1)]),_:1})]),_:1})]),_:1}),c.value.tournament_name?(p(),b(f,{key:1},{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[38]||(e[38]=[i("Tournoi en attente")])),_:1}),l(m,null,{default:t(()=>[i(r(c.value.tournament_name),1)]),_:1})]),_:1})]),_:1})):h("",!0),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[39]||(e[39]=[i("Statut")])),_:1}),l(m,null,{default:t(()=>[l(T,{color:c.value.is_active?"positive":"negative"},{default:t(()=>[i(r(c.value.is_active?"Actif":"Inactif"),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(_,null,{default:t(()=>[l(m,{caption:""},{default:t(()=>e[40]||(e[40]=[i("Date de création")])),_:1}),l(m,null,{default:t(()=>[i(r(Ce(c.value.created_at)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):h("",!0),l(ue,{align:"right"},{default:t(()=>[D(l(w,{flat:"",label:"Fermer",color:"primary"},null,512),[[P]]),l(w,{flat:"",label:"Modifier",color:"secondary",onClick:e[4]||(e[4]=a=>{c.value&&ie(c.value),F.value=!1})})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Y,{modelValue:j.value,"onUpdate:modelValue":e[19]||(e[19]=a=>j.value=a)},{default:t(()=>[l(K,{style:{width:"700px","max-width":"90vw"}},{default:t(()=>[l(Q,{class:"bg-primary text-white"},{default:t(()=>[s("div",rl,r(n.id?"Modifier":"Ajouter")+" un utilisateur",1),D(l(w,{icon:"close",flat:"",round:"",dense:"",class:"absolute-right"},null,512),[[P]])]),_:1}),l(Q,{class:"q-pa-md"},{default:t(()=>[l(Ge,{onSubmit:Fe(Te,["prevent"]),class:"q-gutter-md"},{default:t(()=>[s("div",dl,[e[42]||(e[42]=s("div",{class:"text-subtitle1 q-mb-sm"},"Informations personnelles",-1)),s("div",ul,[s("div",ml,[l(V,{modelValue:n.first_name,"onUpdate:modelValue":e[6]||(e[6]=a=>n.first_name=a),label:"Prénom *",outlined:"",dense:"",rules:[a=>!!a||"Le prénom est requis"]},null,8,["modelValue","rules"])]),s("div",cl,[l(V,{modelValue:n.last_name,"onUpdate:modelValue":e[7]||(e[7]=a=>n.last_name=a),label:"Nom *",outlined:"",dense:"",rules:[a=>!!a||"Le nom est requis"]},null,8,["modelValue","rules"])])]),s("div",fl,[s("div",_l,[l(V,{modelValue:n.email,"onUpdate:modelValue":e[8]||(e[8]=a=>n.email=a),label:"Email *",type:"email",outlined:"",dense:"",rules:[a=>!!a||"L'email est requis",a=>/^[^@]+@[^@]+\.[^@]+$/.test(a)||"Format d'email invalide"]},null,8,["modelValue","rules"])]),s("div",vl,[l(V,{modelValue:n.phone,"onUpdate:modelValue":e[9]||(e[9]=a=>n.phone=a),label:"Téléphone",outlined:"",dense:""},null,8,["modelValue"])])]),s("div",gl,[s("div",pl,[l(V,{modelValue:n.birth_date,"onUpdate:modelValue":e[10]||(e[10]=a=>n.birth_date=a),label:"Date de naissance",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),s("div",bl,[l(x,{modelValue:n.id_gender,"onUpdate:modelValue":e[11]||(e[11]=a=>n.id_gender=a),options:ee,label:"Genre *",outlined:"",dense:"","emit-value":"","map-options":"","menu-self":"top middle","menu-anchor":"bottom middle"},{"no-option":t(()=>[l(f,null,{default:t(()=>[l(_,{class:"text-grey"},{default:t(()=>e[41]||(e[41]=[i(" Aucun genre disponible ")])),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),l(me,{spaced:""}),s("div",wl,[e[46]||(e[46]=s("div",{class:"text-subtitle1 q-mb-sm"},"Informations sportives",-1)),s("div",yl,[s("div",hl,[l(V,{modelValue:n.weight,"onUpdate:modelValue":e[12]||(e[12]=a=>n.weight=a),modelModifiers:{number:!0},label:"Poids (kg)",type:"number",outlined:"",dense:"",min:"30",max:"200"},null,8,["modelValue"])]),s("div",Vl,[l(V,{modelValue:n.nationality,"onUpdate:modelValue":e[13]||(e[13]=a=>n.nationality=a),label:"Nationalité",outlined:"",dense:""},null,8,["modelValue"])])]),s("div",Ul,[s("div",kl,[l(x,{modelValue:n.id_role,"onUpdate:modelValue":e[14]||(e[14]=a=>n.id_role=a),options:X,label:"Rôle *",outlined:"",dense:"","emit-value":"","map-options":"","menu-self":"top middle","menu-anchor":"bottom middle"},{"selected-item":t(({opt:a})=>[l(T,{color:z(a.value)},{default:t(()=>[i(r(a.label),1)]),_:2},1032,["color"])]),"no-option":t(()=>[l(f,null,{default:t(()=>[l(_,{class:"text-grey"},{default:t(()=>e[43]||(e[43]=[i(" Aucun rôle disponible ")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),s("div",xl,[l(x,{modelValue:n.id_club,"onUpdate:modelValue":e[15]||(e[15]=a=>n.id_club=a),options:le.value,label:"Club",outlined:"",dense:"","emit-value":"","map-options":"",clearable:"","menu-self":"top middle","menu-anchor":"bottom middle"},{"no-option":t(()=>[l(f,null,{default:t(()=>[l(_,{class:"text-grey"},{default:t(()=>e[44]||(e[44]=[i(" Aucun club disponible ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),s("div",Al,[l(x,{modelValue:n.id_grade,"onUpdate:modelValue":e[16]||(e[16]=a=>n.id_grade=a),options:we.value,label:"Grade",outlined:"",dense:"","emit-value":"","map-options":"",clearable:"","menu-self":"top middle","menu-anchor":"bottom middle"},{"no-option":t(()=>[l(f,null,{default:t(()=>[l(_,{class:"text-grey"},{default:t(()=>e[45]||(e[45]=[i(" Aucun grade disponible ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])])])]),l(me,{spaced:""}),s("div",ql,[e[47]||(e[47]=s("div",{class:"text-subtitle1 q-mb-sm"},"Informations de compte",-1)),s("div",Cl,[s("div",El,[l(V,{modelValue:n.avatar_seed,"onUpdate:modelValue":e[17]||(e[17]=a=>n.avatar_seed=a),label:"Avatar Seed",outlined:"",dense:"",hint:"Laissez vide pour l'avatar par défaut"},null,8,["modelValue"])]),s("div",Ql,[l(Se,{modelValue:n.is_active,"onUpdate:modelValue":e[18]||(e[18]=a=>n.is_active=a),label:"Compte actif",color:"positive"},null,8,["modelValue"])])])]),s("div",Tl,[D(l(w,{flat:"",label:"Annuler",color:"grey-7",class:"q-mr-sm"},null,512),[[P]]),l(w,{unelevated:"",type:"submit",label:"Enregistrer",color:"primary",loading:$.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Y,{modelValue:S.value,"onUpdate:modelValue":e[21]||(e[21]=a=>S.value=a)},{default:t(()=>[l(K,null,{default:t(()=>[l(Q,{class:de([v.value?.is_active?"bg-negative":"bg-positive","text-white"])},{default:t(()=>[s("div",$l,r(v.value?.is_active?"Désactiver":"Activer")+" le compte",1)]),_:1},8,["class"]),l(Q,{class:"q-pt-md"},{default:t(()=>[v.value?(p(),J("p",Il,[i(" Êtes-vous sûr de vouloir "+r(v.value.is_active?"désactiver":"activer")+" le compte de ",1),s("strong",null,r(v.value.first_name)+" "+r(v.value.last_name),1),e[48]||(e[48]=i(" ? "))])):h("",!0),v.value?.is_active?(p(),J("p",Ll," Un compte désactivé ne peut plus se connecter à l'application. ")):h("",!0)]),_:1}),l(ue,{align:"right",class:"bg-white"},{default:t(()=>[D(l(w,{flat:"",label:"Annuler",color:"primary"},null,512),[[P]]),l(w,{flat:"",label:v.value?.is_active?"Désactiver":"Activer",color:v.value?.is_active?"negative":"positive",onClick:e[20]||(e[20]=a=>Qe()),loading:B.value},null,8,["label","color","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Jl as default};
