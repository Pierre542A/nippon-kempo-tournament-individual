import{i as Lt,e as Xe,az as xt,g as Ve,r as $,b as V,o as Tt,J as it,K as qe,am as Nt,h as J,ae as X,X as Rt,au as Ut,aA as jt,z as Ae,a as Ee,aB as Ye,E as nt,w as Pe,aC as zt,aD as Ot,d as Ge,M as Qt,k as Bt,m as Ze,n as Ie,p as et,q as Gt,s as je,t as vt,y as Jt,aE as qt,aF as Ht,aG as Kt,B as kt,D as Pt,L as Wt,Y as Je,V as St,a6 as le,aq as Vt,a5 as ue,a1 as o,a0 as e,$ as l,a3 as x,_ as ce,a4 as k,a2 as ae,ac as $t,ad as re,al as O,x as Xt,aH as Yt,aI as Zt,aJ as el,aK as tl,aL as ll,aM as al,aN as pt,aO as nl,aP as ol,v as rl,aa as be,ab as me,ai as Oe,ap as bt,a9 as Qe,ag as st,aQ as il,aR as sl,ay as Ne,ao as ot,Z as ul,a8 as gt,ah as _t,ak as dl}from"./index-DRsz5w2d.js";import{Q as rt}from"./QBanner-DIkF7s1T.js";import{Q as cl,g as ht,s as yt}from"./touch-DRKvX4xB.js";import{r as ml,c as fl,i as vl,h as xe,a as Te,e as ne,f as oe,d as K}from"./QSelect-BQUXwyF1.js";import{Q as It}from"./QSpace-B1yT5Z3V.js";import{Q as ge,a as Be,b as fe}from"./QTable-CR_Qw671.js";import{Q as wt}from"./QImg-Bpmswd2f.js";import{Q as De}from"./QTooltip-BeCuxwp4.js";import{Q as pl}from"./QTr-Bc9BNqo7.js";import{Q as bl}from"./QList-Myhhz7id.js";import{Q as At}from"./QForm-Cx9K0l2g.js";import{Q as gl}from"./QPage-D-rMEcpj.js";import{C as Se}from"./ClosePopup-D3O_dCn1.js";import{u as ut}from"./use-quasar-BkUvSKY7.js";import{_ as _l}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as tt}from"./QExpansionItem-COPq9p8b.js";import"./QSlideTransition-BEVZEWQ5.js";let hl=0;const yl=["click","keydown"],wl={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${hl++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function Cl(t,p,u,q){const i=Lt(xt,Xe);if(i===Xe)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Xe;const{proxy:n}=Ve(),h=$(null),m=$(null),D=$(null),Q=V(()=>t.disable===!0||t.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},t.ripple===!0?{}:t.ripple)),P=V(()=>i.currentModel.value===t.name),M=V(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(P.value===!0?" q-tab--active"+(i.tabProps.value.activeClass?" "+i.tabProps.value.activeClass:"")+(i.tabProps.value.activeColor?` text-${i.tabProps.value.activeColor}`:"")+(i.tabProps.value.activeBgColor?` bg-${i.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(t.icon&&t.label&&i.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(t.noCaps===!0||i.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(t.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")),F=V(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(i.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(t.contentClass!==void 0?` ${t.contentClass}`:"")),U=V(()=>t.disable===!0||i.hasFocus.value===!0||P.value===!1&&i.hasActiveTab.value===!0?-1:t.tabindex||0);function j(s,_){if(_!==!0&&h.value!==null&&h.value.focus(),t.disable!==!0){i.updateModel({name:t.name}),u("click",s);return}}function A(s){Ut(s,[13,32])?j(s,!0):jt(s)!==!0&&s.keyCode>=35&&s.keyCode<=40&&s.altKey!==!0&&s.metaKey!==!0&&i.onKbdNavigate(s.keyCode,n.$el)===!0&&Ae(s),u("keydown",s)}function f(){const s=i.tabProps.value.narrowIndicator,_=[],I=J("div",{ref:D,class:["q-tab__indicator",i.tabProps.value.indicatorClass]});t.icon!==void 0&&_.push(J(X,{class:"q-tab__icon",name:t.icon})),t.label!==void 0&&_.push(J("div",{class:"q-tab__label"},t.label)),t.alert!==!1&&_.push(t.alertIcon!==void 0?J(X,{class:"q-tab__alert-icon",color:t.alert!==!0?t.alert:void 0,name:t.alertIcon}):J("div",{class:"q-tab__alert"+(t.alert!==!0?` text-${t.alert}`:"")})),s===!0&&_.push(I);const y=[J("div",{class:"q-focus-helper",tabindex:-1,ref:h}),J("div",{class:F.value},Rt(p.default,_))];return s===!1&&y.push(I),y}const d={name:V(()=>t.name),rootRef:m,tabIndicatorRef:D,routeData:q};Tt(()=>{i.unregisterTab(d)}),it(()=>{i.registerTab(d)});function b(s,_){const I={ref:m,class:M.value,tabindex:U.value,role:"tab","aria-selected":P.value===!0?"true":"false","aria-disabled":t.disable===!0?"true":void 0,onClick:j,onKeydown:A,..._};return qe(J(s,I,f()),[[Nt,Q.value]])}return{renderTab:b,$tabs:i}}const lt=Ee({name:"QTab",props:wl,emits:yl,setup(t,{slots:p,emit:u}){const{renderTab:q}=Cl(t,p,u);return()=>q("div")}});function xl(t,p,u){const q=u===!0?["left","right"]:["top","bottom"];return`absolute-${p===!0?q[0]:q[1]}${t?` text-${t}`:""}`}const Tl=["left","center","right","justify"],ql=Ee({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:t=>Tl.includes(t)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(t,{slots:p,emit:u}){const{proxy:q}=Ve(),{$q:i}=q,{registerTick:n}=Ye(),{registerTick:h}=Ye(),{registerTick:m}=Ye(),{registerTimeout:D,removeTimeout:Q}=nt(),{registerTimeout:P,removeTimeout:M}=nt(),F=$(null),U=$(null),j=$(t.modelValue),A=$(!1),f=$(!0),d=$(!1),b=$(!1),s=[],_=$(0),I=$(!1);let y=null,G=null,H;const z=V(()=>({activeClass:t.activeClass,activeColor:t.activeColor,activeBgColor:t.activeBgColor,indicatorClass:xl(t.indicatorColor,t.switchIndicator,t.vertical),narrowIndicator:t.narrowIndicator,inlineLabel:t.inlineLabel,noCaps:t.noCaps})),w=V(()=>{const g=_.value,S=j.value;for(let N=0;N<g;N++)if(s[N].name.value===S)return!0;return!1}),R=V(()=>`q-tabs__content--align-${A.value===!0?"left":b.value===!0?"justify":t.align}`),C=V(()=>`q-tabs row no-wrap items-center q-tabs--${A.value===!0?"":"not-"}scrollable q-tabs--${t.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${t.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${t.mobileArrows===!0?"":"out"}-arrows`+(t.dense===!0?" q-tabs--dense":"")+(t.shrink===!0?" col-shrink":"")+(t.stretch===!0?" self-stretch":"")),T=V(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+R.value+(t.contentClass!==void 0?` ${t.contentClass}`:"")),c=V(()=>t.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),L=V(()=>t.vertical!==!0&&i.lang.rtl===!0),ee=V(()=>ml===!1&&L.value===!0);Pe(L,_e),Pe(()=>t.modelValue,g=>{E({name:g,setCurrent:!0,skipEmit:!0})}),Pe(()=>t.outsideArrows,te);function E({name:g,setCurrent:S,skipEmit:N}){j.value!==g&&(N!==!0&&t["onUpdate:modelValue"]!==void 0&&u("update:modelValue",g),(S===!0||t["onUpdate:modelValue"]===void 0)&&(ke(j.value,g),j.value=g))}function te(){n(()=>{F.value&&ie({width:F.value.offsetWidth,height:F.value.offsetHeight})})}function ie(g){if(c.value===void 0||U.value===null)return;const S=g[c.value.container],N=Math.min(U.value[c.value.scroll],Array.prototype.reduce.call(U.value.children,(Z,W)=>Z+(W[c.value.content]||0),0)),Y=S>0&&N>S;A.value=Y,Y===!0&&h(_e),b.value=S<parseInt(t.breakpoint,10)}function ke(g,S){const N=g!=null&&g!==""?s.find(Z=>Z.name.value===g):null,Y=S!=null&&S!==""?s.find(Z=>Z.name.value===S):null;if(Ue===!0)Ue=!1;else if(N&&Y){const Z=N.tabIndicatorRef.value,W=Y.tabIndicatorRef.value;y!==null&&(clearTimeout(y),y=null),Z.style.transition="none",Z.style.transform="none",W.style.transition="none",W.style.transform="none";const B=Z.getBoundingClientRect(),se=W.getBoundingClientRect();W.style.transform=t.vertical===!0?`translate3d(0,${B.top-se.top}px,0) scale3d(1,${se.height?B.height/se.height:1},1)`:`translate3d(${B.left-se.left}px,0,0) scale3d(${se.width?B.width/se.width:1},1,1)`,m(()=>{y=setTimeout(()=>{y=null,W.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",W.style.transform="none"},70)})}Y&&A.value===!0&&ve(Y.rootRef.value)}function ve(g){const{left:S,width:N,top:Y,height:Z}=U.value.getBoundingClientRect(),W=g.getBoundingClientRect();let B=t.vertical===!0?W.top-Y:W.left-S;if(B<0){U.value[t.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(B),_e();return}B+=t.vertical===!0?W.height-Z:W.width-N,B>0&&(U.value[t.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(B),_e())}function _e(){const g=U.value;if(g===null)return;const S=g.getBoundingClientRect(),N=t.vertical===!0?g.scrollTop:Math.abs(g.scrollLeft);L.value===!0?(f.value=Math.ceil(N+S.width)<g.scrollWidth-1,d.value=N>0):(f.value=N>0,d.value=t.vertical===!0?Math.ceil(N+S.height)<g.scrollHeight:Math.ceil(N+S.width)<g.scrollWidth)}function Me(g){G!==null&&clearInterval(G),G=setInterval(()=>{a(g)===!0&&pe()},5)}function Re(){Me(ee.value===!0?Number.MAX_SAFE_INTEGER:0)}function Fe(){Me(ee.value===!0?0:Number.MAX_SAFE_INTEGER)}function pe(){G!==null&&(clearInterval(G),G=null)}function He(g,S){const N=Array.prototype.filter.call(U.value.children,se=>se===S||se.matches&&se.matches(".q-tab.q-focusable")===!0),Y=N.length;if(Y===0)return;if(g===36)return ve(N[0]),N[0].focus(),!0;if(g===35)return ve(N[Y-1]),N[Y-1].focus(),!0;const Z=g===(t.vertical===!0?38:37),W=g===(t.vertical===!0?40:39),B=Z===!0?-1:W===!0?1:void 0;if(B!==void 0){const se=L.value===!0?-1:1,he=N.indexOf(S)+B*se;return he>=0&&he<Y&&(ve(N[he]),N[he].focus({preventScroll:!0})),!0}}const v=V(()=>ee.value===!0?{get:g=>Math.abs(g.scrollLeft),set:(g,S)=>{g.scrollLeft=-S}}:t.vertical===!0?{get:g=>g.scrollTop,set:(g,S)=>{g.scrollTop=S}}:{get:g=>g.scrollLeft,set:(g,S)=>{g.scrollLeft=S}});function a(g){const S=U.value,{get:N,set:Y}=v.value;let Z=!1,W=N(S);const B=g<W?-1:1;return W+=B*5,W<0?(Z=!0,W=0):(B===-1&&W<=g||B===1&&W>=g)&&(Z=!0,W=g),Y(S,W),_e(),Z}function r(g,S){for(const N in g)if(g[N]!==S[N])return!1;return!0}function de(){let g=null,S={matchedLen:0,queryDiff:9999,hrefLen:0};const N=s.filter(B=>B.routeData!==void 0&&B.routeData.hasRouterLink.value===!0),{hash:Y,query:Z}=q.$route,W=Object.keys(Z).length;for(const B of N){const se=B.routeData.exact.value===!0;if(B.routeData[se===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:he,query:Ke,matched:Mt,href:Ft}=B.routeData.resolvedLink.value,We=Object.keys(Ke).length;if(se===!0){if(he!==Y||We!==W||r(Z,Ke)===!1)continue;g=B.name.value;break}if(he!==""&&he!==Y||We!==0&&r(Ke,Z)===!1)continue;const Ce={matchedLen:Mt.length,queryDiff:W-We,hrefLen:Ft.length-he.length};if(Ce.matchedLen>S.matchedLen){g=B.name.value,S=Ce;continue}else if(Ce.matchedLen!==S.matchedLen)continue;if(Ce.queryDiff<S.queryDiff)g=B.name.value,S=Ce;else if(Ce.queryDiff!==S.queryDiff)continue;Ce.hrefLen>S.hrefLen&&(g=B.name.value,S=Ce)}if(g===null&&s.some(B=>B.routeData===void 0&&B.name.value===j.value)===!0){Ue=!1;return}E({name:g,setCurrent:!0})}function ye(g){if(Q(),I.value!==!0&&F.value!==null&&g.target&&typeof g.target.closest=="function"){const S=g.target.closest(".q-tab");S&&F.value.contains(S)===!0&&(I.value=!0,A.value===!0&&ve(S))}}function we(){D(()=>{I.value=!1},30)}function Le(){ct.avoidRouteWatcher===!1?P(de):M()}function dt(){if(H===void 0){const g=Pe(()=>q.$route.fullPath,Le);H=()=>{g(),H=void 0}}}function Dt(g){s.push(g),_.value++,te(),g.routeData===void 0||q.$route===void 0?P(()=>{if(A.value===!0){const S=j.value,N=S!=null&&S!==""?s.find(Y=>Y.name.value===S):null;N&&ve(N.rootRef.value)}}):(dt(),g.routeData.hasRouterLink.value===!0&&Le())}function Et(g){s.splice(s.indexOf(g),1),_.value--,te(),H!==void 0&&g.routeData!==void 0&&(s.every(S=>S.routeData===void 0)===!0&&H(),Le())}const ct={currentModel:j,tabProps:z,hasFocus:I,hasActiveTab:w,registerTab:Dt,unregisterTab:Et,verifyRouteModel:Le,updateModel:E,onKbdNavigate:He,avoidRouteWatcher:!1};Qt(xt,ct);function mt(){y!==null&&clearTimeout(y),pe(),H!==void 0&&H()}let ft,Ue;return Tt(mt),zt(()=>{ft=H!==void 0,mt()}),Ot(()=>{ft===!0&&(dt(),Ue=!0,Le()),te()}),()=>J("div",{ref:F,class:C.value,role:"tablist",onFocusin:ye,onFocusout:we},[J(cl,{onResize:ie}),J("div",{ref:U,class:T.value,onScroll:_e},Ge(p.default)),J(X,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(f.value===!0?"":" q-tabs__arrow--faded"),name:t.leftIcon||i.iconSet.tabs[t.vertical===!0?"up":"left"],onMousedownPassive:Re,onTouchstartPassive:Re,onMouseupPassive:pe,onMouseleavePassive:pe,onTouchendPassive:pe}),J(X,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(d.value===!0?"":" q-tabs__arrow--faded"),name:t.rightIcon||i.iconSet.tabs[t.vertical===!0?"down":"right"],onMousedownPassive:Fe,onTouchstartPassive:Fe,onMouseupPassive:pe,onMouseleavePassive:pe,onTouchendPassive:pe})])}});function kl(t){const p=[.06,6,50];return typeof t=="string"&&t.length&&t.split(":").forEach((u,q)=>{const i=parseFloat(u);i&&(p[q]=i)}),p}const Pl=Bt({name:"touch-swipe",beforeMount(t,{value:p,arg:u,modifiers:q}){if(q.mouse!==!0&&Ie.has.touch!==!0)return;const i=q.mouseCapture===!0?"Capture":"",n={handler:p,sensitivity:kl(u),direction:ht(q),noop:Gt,mouseStart(h){yt(h,n)&&Jt(h)&&(je(n,"temp",[[document,"mousemove","move",`notPassive${i}`],[document,"mouseup","end","notPassiveCapture"]]),n.start(h,!0))},touchStart(h){if(yt(h,n)){const m=h.target;je(n,"temp",[[m,"touchmove","move","notPassiveCapture"],[m,"touchcancel","end","notPassiveCapture"],[m,"touchend","end","notPassiveCapture"]]),n.start(h)}},start(h,m){Ie.is.firefox===!0&&et(t,!0);const D=vt(h);n.event={x:D.left,y:D.top,time:Date.now(),mouse:m===!0,dir:!1}},move(h){if(n.event===void 0)return;if(n.event.dir!==!1){Ae(h);return}const m=Date.now()-n.event.time;if(m===0)return;const D=vt(h),Q=D.left-n.event.x,P=Math.abs(Q),M=D.top-n.event.y,F=Math.abs(M);if(n.event.mouse!==!0){if(P<n.sensitivity[1]&&F<n.sensitivity[1]){n.end(h);return}}else if(window.getSelection().toString()!==""){n.end(h);return}else if(P<n.sensitivity[2]&&F<n.sensitivity[2])return;const U=P/m,j=F/m;n.direction.vertical===!0&&P<F&&P<100&&j>n.sensitivity[0]&&(n.event.dir=M<0?"up":"down"),n.direction.horizontal===!0&&P>F&&F<100&&U>n.sensitivity[0]&&(n.event.dir=Q<0?"left":"right"),n.direction.up===!0&&P<F&&M<0&&P<100&&j>n.sensitivity[0]&&(n.event.dir="up"),n.direction.down===!0&&P<F&&M>0&&P<100&&j>n.sensitivity[0]&&(n.event.dir="down"),n.direction.left===!0&&P>F&&Q<0&&F<100&&U>n.sensitivity[0]&&(n.event.dir="left"),n.direction.right===!0&&P>F&&Q>0&&F<100&&U>n.sensitivity[0]&&(n.event.dir="right"),n.event.dir!==!1?(Ae(h),n.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),fl(),n.styleCleanup=A=>{n.styleCleanup=void 0,document.body.classList.remove("non-selectable");const f=()=>{document.body.classList.remove("no-pointer-events--children")};A===!0?setTimeout(f,50):f()}),n.handler({evt:h,touch:n.event.mouse!==!0,mouse:n.event.mouse,direction:n.event.dir,duration:m,distance:{x:P,y:F}})):n.end(h)},end(h){n.event!==void 0&&(Ze(n,"temp"),Ie.is.firefox===!0&&et(t,!1),n.styleCleanup!==void 0&&n.styleCleanup(!0),h!==void 0&&n.event.dir!==!1&&Ae(h),n.event=void 0)}};if(t.__qtouchswipe=n,q.mouse===!0){const h=q.mouseCapture===!0||q.mousecapture===!0?"Capture":"";je(n,"main",[[t,"mousedown","mouseStart",`passive${h}`]])}Ie.has.touch===!0&&je(n,"main",[[t,"touchstart","touchStart",`passive${q.capture===!0?"Capture":""}`],[t,"touchmove","noop","notPassiveCapture"]])},updated(t,p){const u=t.__qtouchswipe;u!==void 0&&(p.oldValue!==p.value&&(typeof p.value!="function"&&u.end(),u.handler=p.value),u.direction=ht(p.modifiers))},beforeUnmount(t){const p=t.__qtouchswipe;p!==void 0&&(Ze(p,"main"),Ze(p,"temp"),Ie.is.firefox===!0&&et(t,!1),p.styleCleanup!==void 0&&p.styleCleanup(),delete t.__qtouchswipe)}});function Sl(){let t=Object.create(null);return{getCache:(p,u)=>t[p]===void 0?t[p]=typeof u=="function"?u():u:t[p],setCache(p,u){t[p]=u},hasCache(p){return Object.hasOwnProperty.call(t,p)},clearCache(p){p!==void 0?delete t[p]:t=Object.create(null)}}}const Vl={name:{required:!0},disable:Boolean},Ct={setup(t,{slots:p}){return()=>J("div",{class:"q-panel scroll",role:"tabpanel"},Ge(p.default))}},$l={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},Il=["update:modelValue","beforeTransition","transition"];function Al(){const{props:t,emit:p,proxy:u}=Ve(),{getCache:q}=Sl(),{registerTimeout:i}=nt();let n,h;const m=$(null),D={value:null};function Q(c){const L=t.vertical===!0?"up":"left";H((u.$q.lang.rtl===!0?-1:1)*(c.direction===L?1:-1))}const P=V(()=>[[Pl,Q,void 0,{horizontal:t.vertical!==!0,vertical:t.vertical,mouse:!0}]]),M=V(()=>t.transitionPrev||`slide-${t.vertical===!0?"down":"right"}`),F=V(()=>t.transitionNext||`slide-${t.vertical===!0?"up":"left"}`),U=V(()=>`--q-transition-duration: ${t.transitionDuration}ms`),j=V(()=>typeof t.modelValue=="string"||typeof t.modelValue=="number"?t.modelValue:String(t.modelValue)),A=V(()=>({include:t.keepAliveInclude,exclude:t.keepAliveExclude,max:t.keepAliveMax})),f=V(()=>t.keepAliveInclude!==void 0||t.keepAliveExclude!==void 0);Pe(()=>t.modelValue,(c,L)=>{const ee=_(c)===!0?I(c):-1;h!==!0&&G(ee===-1?0:ee<I(L)?-1:1),D.value!==ee&&(D.value=ee,p("beforeTransition",c,L),i(()=>{p("transition",c,L)},t.transitionDuration))});function d(){H(1)}function b(){H(-1)}function s(c){p("update:modelValue",c)}function _(c){return c!=null&&c!==""}function I(c){return n.findIndex(L=>L.props.name===c&&L.props.disable!==""&&L.props.disable!==!0)}function y(){return n.filter(c=>c.props.disable!==""&&c.props.disable!==!0)}function G(c){const L=c!==0&&t.animated===!0&&D.value!==-1?"q-transition--"+(c===-1?M.value:F.value):null;m.value!==L&&(m.value=L)}function H(c,L=D.value){let ee=L+c;for(;ee!==-1&&ee<n.length;){const E=n[ee];if(E!==void 0&&E.props.disable!==""&&E.props.disable!==!0){G(c),h=!0,p("update:modelValue",E.props.name),setTimeout(()=>{h=!1});return}ee+=c}t.infinite===!0&&n.length!==0&&L!==-1&&L!==n.length&&H(c,c===-1?n.length:-1)}function z(){const c=I(t.modelValue);return D.value!==c&&(D.value=c),!0}function w(){const c=_(t.modelValue)===!0&&z()&&n[D.value];return t.keepAlive===!0?[J(Kt,A.value,[J(f.value===!0?q(j.value,()=>({...Ct,name:j.value})):Ct,{key:j.value,style:U.value},()=>c)])]:[J("div",{class:"q-panel scroll",style:U.value,key:j.value,role:"tabpanel"},[c])]}function R(){if(n.length!==0)return t.animated===!0?[J(qt,{name:m.value},w)]:w()}function C(c){return n=Ht(Ge(c.default,[])).filter(L=>L.props!==null&&L.props.slot===void 0&&_(L.props.name)===!0),n.length}function T(){return n}return Object.assign(u,{next:d,previous:b,goTo:s}),{panelIndex:D,panelDirectives:P,updatePanelsList:C,updatePanelIndex:z,getPanelContent:R,getEnabledPanels:y,getPanels:T,isValidPanelName:_,keepAliveProps:A,needsUniqueKeepAliveWrapper:f,goToPanelByOffset:H,goToPanel:s,nextPanel:d,previousPanel:b}}const at=Ee({name:"QTabPanel",props:Vl,setup(t,{slots:p}){return()=>J("div",{class:"q-tab-panel",role:"tabpanel"},Ge(p.default))}}),Dl=Ee({name:"QTabPanels",props:{...$l,...kt},emits:Il,setup(t,{slots:p}){const u=Ve(),q=Pt(t,u.proxy.$q),{updatePanelsList:i,getPanelContent:n,panelDirectives:h}=Al(),m=V(()=>"q-tab-panels q-panel-parent"+(q.value===!0?" q-tab-panels--dark q-dark":""));return()=>(i(p),Wt("div",{class:m.value},n(),"pan",t.swipeable,()=>h.value))}}),El={key:0,class:"club-disabled-indicator"},Ml={class:"club-header"},Fl={class:"club-title"},Ll={class:"text-h5 q-my-none text-primary"},Nl={class:"buttons-container"},Rl={class:"form-field"},Ul={class:"field-label"},jl={class:"form-field"},zl={class:"field-label"},Ol={class:"form-field"},Ql={class:"field-label"},Bl={class:"form-field"},Gl={class:"field-label"},Jl={class:"form-field"},Hl={class:"field-label"},Kl={class:"form-row"},Wl={class:"form-field city-field"},Xl={class:"field-label"},Yl={class:"form-field postal-field"},Zl={class:"field-label"},ea={key:0,class:"disabled-info q-my-md"},ta={class:"form-actions"},la=Je({__name:"ClubInfoEditor",props:{club:{}},emits:["club-updated"],setup(t,{emit:p}){const u=t,q=p,i=ut(),n=$(!1),h=$({name:"",street:"",city:"",postal_code:"",phone:"",email:"",website:""}),m=St({name:"",street:"",city:"",postal_code:"",phone:"",email:"",website:""}),D=V(()=>Object.keys(m).some(f=>{const d=f;return m[d]!==h.value[d]}));Pe(()=>u.club,Q,{immediate:!0});function Q(){Object.assign(m,u.club),m.website=u.club.website||"",h.value={name:u.club.name,street:u.club.street,city:u.club.city,postal_code:u.club.postal_code,phone:u.club.phone,email:u.club.email,website:u.club.website||""}}function P(){Object.assign(m,h.value),i.notify({color:"info",message:"Formulaire réinitialisé",icon:"refresh",position:"top-right",timeout:2e3})}const M={required:f=>!!f||"Champ requis",email:f=>!f||/^[^@]+@[^@]+\.[^@]+$/.test(f)||"Email invalide",url:f=>!f||/^https?:\/\/.+/.test(f)||"URL invalide"};async function F(){if(D.value){n.value=!0;try{const d=await fetch(`undefined/clubs/${u.club.id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m.name,street:m.street,city:m.city,postal_code:m.postal_code,phone:m.phone,email:m.email,website:m.website||void 0,is_active:!0})});if(!d.ok){const b=await d.json();throw new Error(b.error||"Une erreur est survenue")}h.value={...m},i.notify({color:"positive",message:"Club mis à jour",icon:"check",position:"top-right",timeout:2e3}),q("club-updated")}catch(f){let d="Erreur lors de la mise à jour du club";f instanceof Error?d=f.message:typeof f=="object"&&f!==null&&"message"in f&&(d=String(f.message)),i.notify({color:"negative",message:d,icon:"error",position:"top-right",timeout:4e3})}finally{n.value=!1}}}function U(){if(!u.club.is_active){i.notify({color:"warning",message:"Ce club est déjà désactivé",icon:"info",position:"top-right",timeout:2e3});return}i.dialog({title:"Supprimer le club",message:"Êtes-vous sûr ? Le club ne peut être supprimé que s'il n'y a plus de joueurs et si vous êtes le dernier administrateur ou gestionnaire.",ok:{label:"Supprimer",color:"negative",icon:"delete"},cancel:{label:"Annuler",flat:!0},persistent:!0}).onOk(j)}async function j(){if(!u.club.is_active){i.notify({color:"warning",message:"Ce club est déjà désactivé",icon:"info",position:"top-right",timeout:2e3});return}n.value=!0;try{const d=await fetch(`undefined/clubs/${u.club.id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:!1})});if(d.status===409||d.status===403){const b=await d.json();i.notify({color:"warning",message:b.error||"Impossible de supprimer le club",icon:"warning",position:"top-right",timeout:6e3});return}if(!d.ok){const b=await d.json();throw new Error(b.error||"Une erreur est survenue")}i.notify({color:"positive",message:"Club désactivé",icon:"check",position:"top-right",timeout:2e3}),q("club-updated")}catch(f){let d="Erreur lors de la suppression du club";f instanceof Error?d=f.message:typeof f=="object"&&f!==null&&"message"in f&&(d=String(f.message)),i.notify({color:"negative",message:d,icon:"error",position:"top-right",timeout:4e3})}finally{n.value=!1}}async function A(){if(u.club.is_active){i.notify({color:"info",message:"Ce club est déjà actif",icon:"info",position:"top-right",timeout:2e3});return}n.value=!0;try{const d=await fetch(`undefined/clubs/${u.club.id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m.name,email:m.email,phone:m.phone,street:m.street,city:m.city,postal_code:m.postal_code,website:m.website||void 0,is_active:!0})});if(!d.ok){const b=await d.json();throw new Error(b.error||"Une erreur est survenue")}i.notify({color:"positive",message:"Club réactivé avec succès",icon:"check_circle",position:"top-right",timeout:2e3}),q("club-updated")}catch(f){let d="Erreur lors de la réactivation du club";f instanceof Error?d=f.message:typeof f=="object"&&f!==null&&"message"in f&&(d=String(f.message)),i.notify({color:"negative",message:d,icon:"error",position:"top-right",timeout:4e3})}finally{n.value=!1}}return(f,d)=>(O(),le("div",{class:Vt(["club-info-container",{"disabled-club":!u.club.is_active}])},[u.club.is_active?ue("",!0):(O(),le("div",El,[e(ge,{color:"negative",class:"disabled-badge"},{default:l(()=>[e(X,{name:"warning"}),d[7]||(d[7]=x(" CLUB DÉSACTIVÉ "))]),_:1})])),o("div",Ml,[o("div",Fl,[e(X,{name:"business",color:"primary",size:"28px",class:"q-mr-sm"}),o("h2",Ll,[x(k(u.club.name)+" ",1),u.club.is_active?ue("",!0):(O(),ce(De,{key:0},{default:l(()=>d[8]||(d[8]=[x(" Ce club est désactivé et n'est plus visible pour les utilisateurs ")])),_:1}))]),u.club.is_active?ue("",!0):(O(),ce(ge,{key:0,color:"negative",class:"q-ml-sm",outline:""},{default:l(()=>d[9]||(d[9]=[x(" Désactivé ")])),_:1}))]),o("div",Nl,[e(ae,{flat:"",round:"",color:"negative",icon:"delete",onClick:U,disable:!u.club.is_active},{default:l(()=>[u.club.is_active?ue("",!0):(O(),ce(De,{key:0},{default:l(()=>d[10]||(d[10]=[x(" Ce club est déjà désactivé ")])),_:1}))]),_:1},8,["disable"])])]),e(At,{onSubmit:$t(F,["prevent"]),class:"club-form"},{default:l(()=>[o("div",Rl,[o("div",Ul,[e(X,{name:"badge",color:"primary"}),d[11]||(d[11]=o("span",null,"Nom *",-1))]),e(re,{modelValue:m.name,"onUpdate:modelValue":d[0]||(d[0]=b=>m.name=b),outlined:"",dense:"",class:"full-width",rules:[M.required],readonly:n.value||!u.club.is_active},null,8,["modelValue","rules","readonly"])]),o("div",jl,[o("div",zl,[e(X,{name:"email",color:"primary"}),d[12]||(d[12]=o("span",null,"Email *",-1))]),e(re,{modelValue:m.email,"onUpdate:modelValue":d[1]||(d[1]=b=>m.email=b),outlined:"",dense:"",type:"email",class:"full-width",rules:[M.required,M.email],readonly:n.value||!u.club.is_active},null,8,["modelValue","rules","readonly"])]),o("div",Ol,[o("div",Ql,[e(X,{name:"phone",color:"primary"}),d[13]||(d[13]=o("span",null,"Téléphone",-1))]),e(re,{modelValue:m.phone,"onUpdate:modelValue":d[2]||(d[2]=b=>m.phone=b),outlined:"",dense:"",class:"full-width",readonly:n.value||!u.club.is_active},null,8,["modelValue","readonly"])]),o("div",Bl,[o("div",Gl,[e(X,{name:"language",color:"primary"}),d[14]||(d[14]=o("span",null,"Site Web *",-1))]),e(re,{modelValue:m.website,"onUpdate:modelValue":d[3]||(d[3]=b=>m.website=b),outlined:"",dense:"",class:"full-width",rules:[M.url],readonly:n.value||!u.club.is_active},{append:l(()=>[m.website?(O(),ce(ae,{key:0,flat:"",round:"",dense:"",icon:"open_in_new",type:"a",href:m.website,target:"_blank"},null,8,["href"])):ue("",!0)]),_:1},8,["modelValue","rules","readonly"])]),o("div",Jl,[o("div",Hl,[e(X,{name:"home",color:"primary"}),d[15]||(d[15]=o("span",null,"Adresse *",-1))]),e(re,{modelValue:m.street,"onUpdate:modelValue":d[4]||(d[4]=b=>m.street=b),outlined:"",dense:"",class:"full-width",rules:[M.required],readonly:n.value||!u.club.is_active},null,8,["modelValue","rules","readonly"])]),o("div",Kl,[o("div",Wl,[o("div",Xl,[e(X,{name:"location_city",color:"primary"}),d[16]||(d[16]=o("span",null,"Ville *",-1))]),e(re,{modelValue:m.city,"onUpdate:modelValue":d[5]||(d[5]=b=>m.city=b),outlined:"",dense:"",class:"full-width",rules:[M.required],readonly:n.value||!u.club.is_active},null,8,["modelValue","rules","readonly"])]),o("div",Yl,[o("div",Zl,[e(X,{name:"markunread_mailbox",color:"primary"}),d[17]||(d[17]=o("span",null,"Code postal *",-1))]),e(re,{modelValue:m.postal_code,"onUpdate:modelValue":d[6]||(d[6]=b=>m.postal_code=b),outlined:"",dense:"",class:"full-width",rules:[M.required],readonly:n.value||!u.club.is_active},null,8,["modelValue","rules","readonly"])])]),u.club.is_active?ue("",!0):(O(),le("div",ea,[e(X,{name:"info",color:"blue",size:"20px",class:"q-mr-sm"}),d[18]||(d[18]=x(' Ce club est actuellement désactivé. Cliquez sur le bouton "Réactiver" pour le remettre en service. '))])),o("div",ta,[u.club.is_active?ue("",!0):(O(),ce(ae,{key:0,unelevated:"",color:"positive",icon:"restart_alt",label:"Réactiver le club",class:"reactivate-btn",onClick:A,loading:n.value},null,8,["loading"])),e(It),e(ae,{flat:"",color:"grey-7",label:"Réinitialiser",icon:"refresh",disabled:!D.value||n.value||!u.club.is_active,onClick:P},null,8,["disabled"]),e(ae,{unelevated:"",type:"submit",color:"primary",label:"Enregistrer",icon:"save",loading:n.value,disabled:!D.value||!u.club.is_active},null,8,["loading","disabled"])])]),_:1})],2))}}),aa=_l(la,[["__scopeId","data-v-e4e220b5"]]);function $e(t,p,u,q){const i=[];return t.forEach(n=>{q(n)===!0?i.push(n):p.push({failedPropValidation:u,file:n})}),i}function ze(t){t&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),Ae(t)}const na={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},oa=["rejected"];function ra({editable:t,dnd:p,getFileInput:u,addFilesToQueue:q}){const{props:i,emit:n,proxy:h}=Ve(),m=$(null),D=V(()=>i.accept!==void 0?i.accept.split(",").map(b=>(b=b.trim(),b==="*"?"*/":(b.endsWith("/*")&&(b=b.slice(0,b.length-1)),b.toUpperCase()))):null),Q=V(()=>parseInt(i.maxFiles,10)),P=V(()=>parseInt(i.maxTotalSize,10));function M(b){if(t.value)if(b!==Object(b)&&(b={target:null}),b.target!==null&&b.target.matches('input[type="file"]')===!0)b.clientX===0&&b.clientY===0&&Xt(b);else{const s=u();s&&s!==b.target&&s.click(b)}}function F(b){t.value&&b&&q(null,b)}function U(b,s,_,I){let y=Array.from(s||b.target.files);const G=[],H=()=>{G.length!==0&&n("rejected",G)};if(i.accept!==void 0&&D.value.indexOf("*/")===-1&&(y=$e(y,G,"accept",z=>D.value.some(w=>z.type.toUpperCase().startsWith(w)||z.name.toUpperCase().endsWith(w))),y.length===0))return H();if(i.maxFileSize!==void 0){const z=parseInt(i.maxFileSize,10);if(y=$e(y,G,"max-file-size",w=>w.size<=z),y.length===0)return H()}if(i.multiple!==!0&&y.length!==0&&(y=[y[0]]),y.forEach(z=>{z.__key=z.webkitRelativePath+z.lastModified+z.name+z.size}),I===!0){const z=_.map(w=>w.__key);y=$e(y,G,"duplicate",w=>z.includes(w.__key)===!1)}if(y.length===0)return H();if(i.maxTotalSize!==void 0){let z=I===!0?_.reduce((w,R)=>w+R.size,0):0;if(y=$e(y,G,"max-total-size",w=>(z+=w.size,z<=P.value)),y.length===0)return H()}if(typeof i.filter=="function"){const z=i.filter(y);y=$e(y,G,"filter",w=>z.includes(w))}if(i.maxFiles!==void 0){let z=I===!0?_.length:0;if(y=$e(y,G,"max-files",()=>(z++,z<=Q.value)),y.length===0)return H()}if(H(),y.length!==0)return y}function j(b){ze(b),p.value!==!0&&(p.value=!0)}function A(b){Ae(b),(b.relatedTarget!==null||Ie.is.safari!==!0?b.relatedTarget!==m.value:document.elementsFromPoint(b.clientX,b.clientY).includes(m.value)===!1)===!0&&(p.value=!1)}function f(b){ze(b);const s=b.dataTransfer.files;s.length!==0&&q(null,s),p.value=!1}function d(b){if(p.value===!0)return J("div",{ref:m,class:`q-${b}__dnd absolute-full`,onDragenter:ze,onDragover:ze,onDragleave:A,onDrop:f})}return Object.assign(h,{pickFiles:M,addFiles:F}),{pickFiles:M,addFiles:F,onDragover:j,onDragleave:A,processFiles:U,getDndNode:d,maxFilesNumber:Q,maxTotalSizeNumber:P}}const ia=Ee({name:"QFile",inheritAttrs:!1,props:{...el,...Zt,...na,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Yt,...oa],setup(t,{slots:p,emit:u,attrs:q}){const{proxy:i}=Ve(),n=tl(),h=$(null),m=$(!1),D=ll(t),{pickFiles:Q,onDragover:P,onDragleave:M,processFiles:F,getDndNode:U}=ra({editable:n.editable,dnd:m,getFileInput:C,addFilesToQueue:T}),j=al(t),A=V(()=>Object(t.modelValue)===t.modelValue?"length"in t.modelValue?Array.from(t.modelValue):[t.modelValue]:[]),f=V(()=>pt(A.value)),d=V(()=>A.value.map(E=>E.name).join(", ")),b=V(()=>vl(A.value.reduce((E,te)=>E+te.size,0))),s=V(()=>({totalSize:b.value,filesNumber:A.value.length,maxFiles:t.maxFiles})),_=V(()=>({tabindex:-1,type:"file",title:"",accept:t.accept,capture:t.capture,name:D.value,...q,id:n.targetUid.value,disabled:n.editable.value!==!0})),I=V(()=>"q-file q-field--auto-height"+(m.value===!0?" q-file--dnd":"")),y=V(()=>t.multiple===!0&&t.append===!0);function G(E){const te=A.value.slice();te.splice(E,1),z(te)}function H(E){const te=A.value.indexOf(E);te!==-1&&G(te)}function z(E){u("update:modelValue",t.multiple===!0?E:E[0])}function w(E){E.keyCode===13&&rl(E)}function R(E){(E.keyCode===13||E.keyCode===32)&&Q(E)}function C(){return h.value}function T(E,te){const ie=F(E,te,A.value,y.value),ke=C();ke!=null&&(ke.value=""),ie!==void 0&&((t.multiple===!0?t.modelValue&&ie.every(ve=>A.value.includes(ve)):t.modelValue===ie[0])||z(y.value===!0?A.value.concat(ie):ie))}function c(){return[J("input",{class:[t.inputClass,"q-file__filler"],style:t.inputStyle})]}function L(){if(p.file!==void 0)return A.value.length===0?c():A.value.map((te,ie)=>p.file({index:ie,file:te,ref:this}));if(p.selected!==void 0)return A.value.length===0?c():p.selected({files:A.value,ref:this});if(t.useChips===!0)return A.value.length===0?c():A.value.map((te,ie)=>J(xe,{key:"file-"+ie,removable:n.editable.value,dense:!0,textColor:t.color,tabindex:t.tabindex,onRemove:()=>{G(ie)}},()=>J("span",{class:"ellipsis",textContent:te.name})));const E=t.displayValue!==void 0?t.displayValue:d.value;return E.length!==0?[J("div",{class:t.inputClass,style:t.inputStyle,textContent:E})]:c()}function ee(){const E={ref:h,..._.value,...j.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:T};return t.multiple===!0&&(E.multiple=!0),J("input",E)}return Object.assign(n,{fieldClass:I,emitValue:z,hasValue:f,inputRef:h,innerValue:A,floatingLabel:V(()=>f.value===!0||pt(t.displayValue)),computedCounter:V(()=>{if(t.counterLabel!==void 0)return t.counterLabel(s.value);const E=t.maxFiles;return`${A.value.length}${E!==void 0?" / "+E:""} (${b.value})`}),getControlChild:()=>U("file"),getControl:()=>{const E={ref:n.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:t.tabindex};return n.editable.value===!0&&Object.assign(E,{onDragover:P,onDragleave:M,onKeydown:w,onKeyup:R}),J("div",E,[ee()].concat(L()))}}),Object.assign(i,{removeAtIndex:G,removeFile:H,getNativeElement:()=>h.value}),nl(i,"nativeEl",()=>h.value),ol(n)}}),sa={class:"q-pa-md"},ua={class:"row q-col-gutter-md q-mb-md"},da={class:"col-12"},ca={key:1,class:"q-mb-md"},ma={class:"text-h6"},fa={class:"row q-col-gutter-md"},va={class:"text-h6"},pa={class:"row justify-end"},ba={key:0},ga=Je({__name:"JsonImporter",props:{clubId:{}},setup(t){const p=$("registration"),u=t,q=$(null),i=$(null),n=$(!1),h=$(""),m=$(!1),D=$({}),Q=[{name:"firstName",label:"Prénom",field:"firstName",sortable:!0},{name:"lastName",label:"Nom",field:"lastName",sortable:!0},{name:"birthDate",label:"Date de naissance",field:"birthDate",sortable:!0,format:s=>M(s)},{name:"clubName",label:"Club",field:"clubName",sortable:!0},{name:"weight",label:"Poids",field:"weight",sortable:!0},{name:"email",label:"Email",field:"email",sortable:!0}],P=[{name:"idMatch",label:"ID Match",field:"idMatch",sortable:!0},{name:"players",label:"Combattants",field:s=>s,format:s=>{const _=i.value?.participants?.find(y=>y.id===s.idPlayer1)?.lastName||s.idPlayer1,I=i.value?.participants?.find(y=>y.id===s.idPlayer2)?.lastName||s.idPlayer2;return`${_} vs ${I}`},sortable:!1},{name:"winner",label:"Vainqueur",field:"idWinner",format:s=>s===-1?"Match nul":i.value?.participants?.find(_=>_.id===s)?.lastName||s||"—",sortable:!0},{name:"score",label:"Score (Ippon)",field:s=>s,format:s=>`${s.ipponsPlayer1} - ${s.ipponsPlayer2}`,sortable:!1},{name:"penalties",label:"Pénalités (Keikoku)",field:s=>s,format:s=>`${s.keikokusPlayer1} - ${s.keikokusPlayer2}`,sortable:!1}];function M(s){return s?new Date(s).toLocaleDateString("fr-FR"):"—"}function F(s){return{1:"Masculin",2:"Féminin",3:"Non précisé"}[s]||"Inconnu"}function U(s){return{1:"Poule",2:"Tableau"}[s]||"Inconnu"}function j(s,_){const I={1:"Blanche",2:"Blanche-Jaune",3:"Jaune",4:"Jaune-Orange",5:"Orange",6:"Orange-Verte",7:"Verte",8:"Verte-Bleue",9:"Bleue",10:"Bleue-Marron",11:"Marron",12:"1ère Dan",13:"2ème Dan",14:"3ème Dan",15:"4ème Dan",16:"5ème Dan",17:"6ème Dan"},y=I[s]||"Inconnue",G=I[_]||"Inconnue";return`${y} à ${G}`}async function A(){if(!q.value){i.value=null;return}try{const s=await f(q.value),_=JSON.parse(s);if(!d(_)){q.value=null;return}i.value=_,_.tournaments&&_.tournaments[0]&&_.tournaments[0].started?p.value="results":p.value="registration",h.value=""}catch(s){console.error("Erreur lors de la lecture du fichier:",s),h.value="Erreur lors de la lecture du fichier. Vérifiez que le format est JSON valide.",i.value=null,q.value=null}}function f(s){return new Promise((_,I)=>{const y=new FileReader;y.onload=()=>{typeof y.result=="string"?_(y.result):I(new Error("Erreur de lecture du fichier"))},y.onerror=()=>{I(y.error)},y.readAsText(s)})}function d(s){const _=s;return!_.metadata||!_.tournaments||!Array.isArray(_.tournaments)?(h.value='Le fichier JSON doit contenir les sections "metadata" et "tournaments".',!1):_.tournaments.length===0?(h.value="Aucun tournoi trouvé dans le fichier.",!1):Array.isArray(_.participants)?!0:(h.value='Le fichier doit contenir une section "participants".',!1)}async function b(){if(!i.value||!u.clubId){h.value="Données invalides ou club non spécifié.";return}n.value=!0,h.value="";try{const s=i.value.tournaments[0];if(!s)throw new Error("Aucun tournoi trouvé dans les données");const _={name:s.name,address:s.address||null,start_date:new Date(s.startDate).toISOString().split("T")[0],end_date:new Date(s.startDate).toISOString().split("T")[0],status:i.value?.tournaments?.[0]?.started?"closed":"open",id_club:u.clubId},I=i.value.participants.map(R=>({first_name:R.firstName,last_name:R.lastName,birth_date:R.birthDate,email:R.email,weight:R.weight,genderId:R.genderId,gradeId:R.gradeId,externalId:R.id})),y=i.value.categories.map(R=>({name:R.name,minGradeId:R.minGradeId,maxGradeId:R.maxGradeId,typeId:R.typeId,externalId:R.id})),G=i.value.matches||[],H={tournament:_,participants:I,categories:y,matches:G,importType:i.value?.tournaments?.[0]?.started?"results":"registration"},w="undefined/imports/tournament";try{const R=await fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(H)});if(!R.ok){const T=await R.text();console.error("Réponse d'erreur du serveur:",T);try{const c=JSON.parse(T);throw new Error(c.error||`Erreur HTTP: ${R.status}`)}catch{throw new Error(`Erreur HTTP ${R.status}: ${T||"Réponse vide"}`)}}const C=await R.json();D.value={"Tournoi créé":C.tournamentCreated||0,"Tournoi mis à jour":C.tournamentUpdated||0,"Type d'importation":i.value?.tournaments?.[0]?.started?"Résultats":"Inscriptions","Statut du tournoi":C.tournamentStatus||(p.value==="registration"?"Ouvert":"Fermé"),"Participants traités":I.length,"Participants ajoutés":C.newParticipants||0,"Participants mis à jour":C.updatedParticipants||0,"Catégories créées":C.newCategories||0,"Catégories mises à jour":C.updatedCategories||0,"Matchs importés":C.newMatches||0},m.value=!0,q.value=null,i.value=null}catch(R){throw console.error("Erreur fetch détaillée:",R),R}}catch(s){console.error("Erreur lors de l'importation:",s),h.value=s instanceof Error?s.message:"Erreur lors de l'importation des données."}finally{n.value=!1}}return(s,_)=>(O(),le("div",sa,[_[7]||(_[7]=o("div",{class:"text-subtitle1 q-mb-md"}," Importation de données de tournoi JSON ",-1)),h.value?(O(),ce(rt,{key:0,class:"bg-negative text-white q-mb-md"},{avatar:l(()=>[e(X,{name:"error"})]),default:l(()=>[x(" "+k(h.value),1)]),_:1})):ue("",!0),e(be,{flat:"",bordered:"",class:"q-mb-md"},{default:l(()=>[e(me,null,{default:l(()=>_[2]||(_[2]=[o("div",{class:"text-h6"},"Instructions",-1),o("p",null," Ce module vous permet d'importer des données de tournoi exportées depuis l'application back-office. L'importation inclut: ",-1),o("ul",null,[o("li",null,[o("span",{class:"text-weight-bold"},"Tournoi"),x(" - Configuration, date et adresse ")]),o("li",null,[o("span",{class:"text-weight-bold"},"Participants"),x(" - Participants avec leurs informations (comparaison avec les utilisateurs existants) ")]),o("li",null,[o("span",{class:"text-weight-bold"},"Catégories"),x(" - Catégories du tournoi ")]),o("li",null,[o("span",{class:"text-weight-bold"},"Matchs"),x(" - Matchs du tournoi avec les résultats ")])],-1)])),_:1})]),_:1}),o("div",ua,[o("div",da,[e(ia,{modelValue:q.value,"onUpdate:modelValue":[_[0]||(_[0]=I=>q.value=I),A],label:"Sélectionner un fichier JSON de tournoi *",outlined:"",dense:"",accept:".json"},{prepend:l(()=>[e(X,{name:"attach_file"})]),_:1},8,["modelValue"])])]),i.value?(O(),le("div",ca,[_[3]||(_[3]=o("div",{class:"text-subtitle1 q-mb-sm"},"Aperçu des données",-1)),e(be,{flat:"",bordered:""},{default:l(()=>[e(me,null,{default:l(()=>[o("div",ma,"Tournoi : "+k(i.value.tournaments?.[0]?.name||"Sans nom"),1),o("div",null,"Date : "+k(M(i.value.tournaments?.[0]?.startDate)),1),o("div",null,"Adresse : "+k(i.value.tournaments?.[0]?.address||"Non spécifiée"),1),o("div",null,"Statut du tournoi : "+k(i.value.tournaments?.[0]?.started?"Démarré":"Pas encore démarré"),1),o("div",null,"Type : "+k(i.value.tournaments?.[0]?.started?"Résultats (tournoi terminé)":"Inscriptions (tournoi à venir)"),1),o("div",null,"Catégories : "+k(i.value.categories?.length||0),1),o("div",null,"Participants : "+k(i.value.participants?.length||0),1),o("div",null,"Matchs : "+k(i.value.matches?.length||0),1),e(tt,{label:"Détails des catégories",caption:"Cliquez pour voir les catégories",icon:"category",class:"q-mt-md"},{default:l(()=>[e(be,null,{default:l(()=>[e(me,null,{default:l(()=>[o("div",fa,[(O(!0),le(Oe,null,bt(i.value.categories,(I,y)=>(O(),le("div",{key:y,class:"col-12 col-md-6"},[e(be,{flat:"",bordered:""},{default:l(()=>[e(me,null,{default:l(()=>[o("div",va,k(I.name),1),o("div",null,"Genre: "+k(F(I.genderId)),1),o("div",null,"Type: "+k(U(I.typeId)),1),o("div",null,"Grades: "+k(j(I.minGradeId,I.maxGradeId)),1)]),_:2},1024)]),_:2},1024)]))),128))])]),_:1})]),_:1})]),_:1}),e(tt,{label:"Détails des participants",caption:"Cliquez pour voir les participants",icon:"people",class:"q-mt-md"},{default:l(()=>[e(be,null,{default:l(()=>[e(me,null,{default:l(()=>[e(Be,{title:"Participants",rows:i.value.participants,columns:Q,"row-key":"id",pagination:{rowsPerPage:10},dense:""},null,8,["rows"])]),_:1})]),_:1})]),_:1}),e(tt,{label:"Détails des matchs",caption:"Cliquez pour voir les matchs",icon:"sports_kabaddi",class:"q-mt-md"},{default:l(()=>[e(be,null,{default:l(()=>[e(me,null,{default:l(()=>[e(Be,{title:"Matchs",rows:i.value.matches||[],columns:P,"row-key":"idMatch",pagination:{rowsPerPage:10},dense:""},null,8,["rows"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):ue("",!0),o("div",pa,[e(ae,{unelevated:"",label:"Importer",color:"primary",loading:n.value,disable:!i.value||n.value,onClick:b},null,8,["loading","disable"])]),e(Qe,{modelValue:m.value,"onUpdate:modelValue":_[1]||(_[1]=I=>m.value=I)},{default:l(()=>[e(be,null,{default:l(()=>[e(me,{class:"bg-positive text-white"},{default:l(()=>_[4]||(_[4]=[o("div",{class:"text-h6"},"Importation réussie",-1)])),_:1}),e(me,null,{default:l(()=>[_[6]||(_[6]=o("p",null,"Les données du tournoi ont été importées avec succès.",-1)),D.value?(O(),le("div",ba,[_[5]||(_[5]=o("div",{class:"text-weight-bold"},"Résumé :",-1)),o("ul",null,[(O(!0),le(Oe,null,bt(D.value,(I,y)=>(O(),le("li",{key:y},k(y)+" : "+k(I),1))),128))])])):ue("",!0)]),_:1}),e(st,{align:"right"},{default:l(()=>[qe(e(ae,{flat:"",label:"Fermer",color:"primary"},null,512),[[Se]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),_a=Ee({name:"QInnerLoading",props:{...kt,...il,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(t,{slots:p}){const u=Ve(),q=Pt(t,u.proxy.$q),{transitionProps:i,transitionStyle:n}=sl(t),h=V(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(q.value===!0?" q-inner-loading--dark":"")),m=V(()=>"q-inner-loading__label"+(t.labelClass!==void 0?` ${t.labelClass}`:""));function D(){const P=[J(Ne,{size:t.size,color:t.color})];return t.label!==void 0&&P.push(J("div",{class:m.value,style:t.labelStyle},[t.label])),P}function Q(){return t.showing===!0?J("div",{class:h.value,style:n.value},p.default!==void 0?p.default():D()):null}return()=>J(qt,i.value,Q)}}),ha={class:"row q-mb-md q-col-gutter-md"},ya={class:"col-12 col-md-6"},wa={class:"col-12 col-md-3"},Ca={class:"col-12 col-md-3"},xa={class:"full-width row flex-center q-gutter-sm text-grey q-pa-lg"},Ta={class:"q-ml-sm"},qa=Je({__name:"TournamentManager",props:{clubId:{}},setup(t){const p=t,u=ut(),q=$([]),i=$(!1),n=$(""),h=$(null),m=$(null),D=$(!1),Q=$(""),P=$(null),M=$(null),F=[{label:"Ouvert",value:"open"},{label:"Fermé",value:"closed"}],U=[{label:"Actif",value:!0},{label:"Inactif",value:!1}],j=[{name:"id",label:"ID",field:"id",sortable:!0,align:"left"},{name:"name",label:"Nom",field:"name",sortable:!0,align:"left"},{name:"address",label:"Adresse",field:"address",sortable:!0,align:"left"},{name:"dates",label:"Dates",field:C=>`${C.start_date} - ${C.end_date}`,sortable:!0,align:"left"},{name:"status",label:"Statut",field:"status",sortable:!0,align:"center"},{name:"is_active",label:"Visibilité",field:"is_active",sortable:!0,align:"center"},{name:"actions",label:"Actions",field:"actions",align:"center"}],A=V(()=>P.value==="toggleActive"?M.value?.is_active?"negative":"positive":P.value==="closeTournament"?"orange":"primary"),f=V(()=>P.value==="toggleActive"?M.value?.is_active?"delete":"restore":P.value==="closeTournament"?"lock":"help"),d=V(()=>P.value==="toggleActive"?M.value?.is_active?"Supprimer":"Restaurer":P.value==="closeTournament"?"Clôturer":"Confirmer"),b=V(()=>q.value.filter(C=>{const T=n.value.toLowerCase(),c=!n.value||C.name.toLowerCase().includes(T)||C.address&&C.address.toLowerCase().includes(T),L=h.value===null||C.status===h.value,ee=m.value===null||C.is_active===m.value;return c&&L&&ee})),s=C=>{if(!C)return"—";try{const T=new Date(C);return isNaN(T.getTime())?"—":T.toLocaleDateString("fr-FR")}catch(T){return console.error("Erreur de formatage de date:",T),"—"}},_=C=>({open:"Ouvert",closed:"Fermé"})[C]||C,I=C=>({open:"green",closed:"blue"})[C]||"grey",y=async()=>{if(p.clubId){i.value=!0;try{const C=await fetch(`undefined/clubs/${p.clubId}/tournaments`,{credentials:"include"});if(!C.ok)throw new Error(`Erreur HTTP: ${C.status}`);const T=await C.json();q.value=Array.isArray(T.tournaments)?T.tournaments:[]}catch(C){console.error("Erreur lors du chargement des tournois:",C),u.notify({color:"negative",message:`Erreur: ${C instanceof Error?C.message:"Inconnue"}`,icon:"error"}),q.value=[]}finally{i.value=!1}}},G=C=>{Q.value=C.is_active?`Êtes-vous sûr de vouloir supprimer le tournoi "${C.name}" ?`:`Êtes-vous sûr de vouloir restaurer le tournoi "${C.name}" ?`,P.value="toggleActive",M.value=C,D.value=!0},H=C=>{Q.value=`Êtes-vous sûr de vouloir clôturer le tournoi "${C.name}" ? 
  
ATTENTION: Cette action supprimera toutes les inscriptions en attente pour ce tournoi. Assurez-vous d'avoir accepté tous les participants que vous souhaitiez intégrer avant de clôturer.

Cette action est irréversible.`,P.value="closeTournament",M.value=C,D.value=!0},z=async()=>{if(M.value)try{P.value==="toggleActive"?await w(M.value):P.value==="closeTournament"&&await R(M.value)}catch(C){console.error("Erreur lors de l'action:",C)}finally{P.value=null,M.value=null}},w=async C=>{try{const T=!C.is_active,c=await fetch(`undefined/tournaments/${C.id}/toggle-active`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({is_active:T})});if(!c.ok)throw new Error(`Erreur HTTP: ${c.status}`);const L=await c.json();if(L.success)C.is_active=T,u.notify({color:"positive",message:T?"Tournoi restauré avec succès":"Tournoi supprimé avec succès",icon:"check_circle"});else throw new Error(L.error||"Une erreur est survenue")}catch(T){console.error("Erreur lors de l'action:",T),u.notify({color:"negative",message:`Erreur: ${T instanceof Error?T.message:"Inconnue"}`,icon:"error"})}},R=async C=>{try{const T=await fetch(`undefined/tournaments/${C.id}/close`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})});if(!T.ok){const L=await T.text();throw console.error("Réponse d'erreur du serveur:",L),new Error(`Erreur HTTP: ${T.status}`)}const c=await T.json();if(c.success)C.status="closed",u.notify({color:"positive",message:c.message||"Tournoi clôturé avec succès",icon:"check_circle"});else throw new Error(c.error||"Une erreur est survenue")}catch(T){console.error("Erreur lors de la clôture du tournoi:",T),u.notify({color:"negative",message:`Erreur: ${T instanceof Error?T.message:"Inconnue"}`,icon:"error"})}};return Pe(()=>p.clubId,C=>{C&&y()}),it(()=>{p.clubId&&y()}),(C,T)=>(O(),le("div",null,[o("div",ha,[o("div",ya,[e(re,{modelValue:n.value,"onUpdate:modelValue":T[0]||(T[0]=c=>n.value=c),outlined:"",dense:"",placeholder:"Rechercher par nom ou adresse...",clearable:""},{append:l(()=>[e(X,{name:"search"})]),_:1},8,["modelValue"])]),o("div",wa,[e(Te,{modelValue:h.value,"onUpdate:modelValue":T[1]||(T[1]=c=>h.value=c),options:F,outlined:"",dense:"",placeholder:"Statut (tous)","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])]),o("div",Ca,[e(Te,{modelValue:m.value,"onUpdate:modelValue":T[2]||(T[2]=c=>m.value=c),options:U,outlined:"",dense:"",placeholder:"Visibilité (tous)","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])])]),e(Be,{rows:b.value,columns:j,"row-key":"id",loading:i.value,pagination:{rowsPerPage:10},class:"q-mb-md"},{loading:l(()=>[e(_a,{showing:""},{default:l(()=>[e(Ne,{size:"50px",color:"primary"})]),_:1})]),"body-cell-status":l(c=>[e(fe,{props:c},{default:l(()=>[e(ge,{color:I(c.row.status)},{default:l(()=>[x(k(_(c.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-is_active":l(c=>[e(fe,{props:c},{default:l(()=>[e(ge,{color:c.row.is_active?"positive":"negative"},{default:l(()=>[x(k(c.row.is_active?"Actif":"Inactif"),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-dates":l(c=>[e(fe,{props:c},{default:l(()=>[x(k(s(c.row.start_date))+" - "+k(s(c.row.end_date)),1)]),_:2},1032,["props"])]),"body-cell-actions":l(c=>[e(fe,{props:c,class:"q-gutter-xs"},{default:l(()=>[e(ae,{dense:"",round:"",flat:"",color:c.row.is_active?"negative":"positive",icon:c.row.is_active?"delete":"restore",onClick:L=>G(c.row)},{default:l(()=>[e(De,null,{default:l(()=>[x(k(c.row.is_active?"Supprimer":"Restaurer"),1)]),_:2},1024)]),_:2},1032,["color","icon","onClick"]),c.row.status==="open"?(O(),ce(ae,{key:0,dense:"",round:"",flat:"",color:"orange",icon:"lock",onClick:L=>H(c.row)},{default:l(()=>[e(De,null,{default:l(()=>T[4]||(T[4]=[x("Clôturer le tournoi")])),_:1})]),_:2},1032,["onClick"])):ue("",!0)]),_:2},1032,["props"])]),"no-data":l(()=>[o("div",xa,[e(X,{size:"2em",name:"event_busy"}),T[5]||(T[5]=o("span",null,"Aucun tournoi trouvé",-1))])]),_:1},8,["rows","loading"]),e(Qe,{modelValue:D.value,"onUpdate:modelValue":T[3]||(T[3]=c=>D.value=c),persistent:""},{default:l(()=>[e(be,null,{default:l(()=>[e(me,{class:"row items-center"},{default:l(()=>[e(ot,{icon:f.value,color:A.value,"text-color":"white"},null,8,["icon","color"]),o("span",Ta,k(Q.value),1)]),_:1}),e(st,{align:"right"},{default:l(()=>[qe(e(ae,{flat:"",label:"Annuler",color:"primary"},null,512),[[Se]]),qe(e(ae,{flat:"",label:d.value,color:A.value,onClick:z},null,8,["label","color"]),[[Se]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),ka={key:0},Pa={key:1},Sa={key:2},Va={key:0,class:"text-center q-pa-md"},$a={key:1,class:"text-center q-pa-xl"},Ia={class:"row items-center q-mb-md"},Aa={class:"text-h5 q-my-none"},Da={class:"row q-col-gutter-md q-mb-md"},Ea={class:"col-12 col-md-6"},Ma={class:"col-12 col-md-2"},Fa={class:"col-12 col-md-2"},La={class:"col-12 col-md-2"},Na={class:"row items-center"},Ra={class:"row items-center q-gutter-x-sm"},Ua={class:"row q-gutter-xs justify-center"},ja={class:"full-width row flex-center text-grey q-gutter-sm q-pa-lg"},za={key:0,class:"text-center q-pa-md"},Oa={key:1,class:"text-center q-pa-xl"},Qa={class:"q-pa-md"},Ba={class:"q-pa-md"},Ga={class:"q-pa-md"},Ja={class:"row justify-center q-mb-md"},Ha={class:"q-mb-md"},Ka={class:"row q-col-gutter-md"},Wa={class:"col-12 col-md-6"},Xa={class:"col-12 col-md-6"},Ya={class:"row q-col-gutter-md q-mt-sm"},Za={class:"col-12 col-md-6"},en={class:"col-12 col-md-6"},tn={class:"row q-col-gutter-md q-mt-sm"},ln={class:"col-12 col-md-6"},an={class:"col-12 col-md-6"},nn={class:"q-mb-md"},on={class:"row q-col-gutter-md"},rn={class:"col-12 col-md-6"},sn={class:"col-12 col-md-6"},un={class:"row q-col-gutter-md q-mt-sm"},dn={class:"col-12 col-md-6"},cn={class:"col-12 col-md-6"},mn={class:"row justify-end q-mt-lg"},$n=Je({__name:"ManagerPage",setup(t){const p=ut();dl();const u=ul(),q=$(!0),i=$([]),n=$(null),h=$("members"),m=$(!1),D=$(!1),Q=$(""),P=$(""),M=$(null),F=$(null),U=$(null),j=$(!1),A=$(!1),f=$(null),d=[{label:"Homme",value:1},{label:"Femme",value:2}],b=[{label:"Actif",value:!0},{label:"Inactif",value:!1}],s=V(()=>T.value.map(v=>({label:v.name,value:v.id}))),_=$([]),I=V(()=>v=>{if(!v)return"—";const a=_.value.find(r=>r.id===v);return a?a.name:"—"}),y=V(()=>_.value.map(v=>({label:v.name,value:v.id}))),G=V(()=>i.value.filter(v=>v.id_role===1).length),H=V(()=>i.value.filter(v=>v.id_role===2).length),z=V(()=>i.value.filter(v=>v.id_role===3).length),w=St({id:null,first_name:"",last_name:"",email:"",phone:"",birth_date:"",id_gender:1,weight:null,nationality:"Française",id_grade:null,id_role:3,is_active:!0}),R=V(()=>v=>{if(!v)return"—";const a=T.value.find(r=>r.id===v);return a?a.name:`Rôle #${v}`});function C(v){return{1:"purple",2:"blue",3:"green"}[v]||"grey"}const T=$([{id:1,name:"Admin"},{id:2,name:"Manager"},{id:3,name:"Joueur"}]),c=[{name:"id",label:"ID",field:"id",sortable:!0,align:"left"},{name:"name",label:"Nom",field:v=>`${v.first_name} ${v.last_name}`,sortable:!0,align:"left"},{name:"email",label:"Email",field:"email",sortable:!0,align:"left"},{name:"info",label:"Informations",field:"info",sortable:!1,align:"left"},{name:"role",label:"Rôle",field:"id_role",sortable:!0,align:"center"},{name:"grade",label:"Grade",field:"id_grade",sortable:!0,align:"center"},{name:"status",label:"Statut",field:"is_active",sortable:!0,align:"center"},{name:"actions",label:"Actions",field:"actions",sortable:!1,align:"center"}],L=V(()=>i.value.filter(v=>{const a=!P.value||v.first_name.toLowerCase().includes(P.value.toLowerCase())||v.last_name.toLowerCase().includes(P.value.toLowerCase())||v.email.toLowerCase().includes(P.value.toLowerCase()),r=M.value===null||!!v.is_active==!!M.value,de=F.value===null||v.id_grade===F.value,ye=U.value===null||v.id_role===U.value;return a&&r&&de&&ye})),ee=v=>v?new Date(v).toLocaleDateString("fr-FR"):"—",E=v=>`https://api.dicebear.com/6.x/avataaars/svg?seed=${v}&size=64`,te=(v,a,r)=>`${v} à ${a} sur ${r}`,ie=v=>{if(!v)return"—";try{const a=new Date(v);return isNaN(a.getTime())?"—":a.toLocaleString("fr-FR")}catch(a){return console.error("Erreur lors du formatage de la date de création:",a),"—"}};async function ke(){q.value=!0;try{if(!u.user||u.user.id_role!==2||!u.user.id_club)return;await ve()}catch(v){console.error("[checkUserClub] catch →",v),Q.value="Erreur lors du chargement…"}finally{q.value=!1}}async function ve(){if(!u.user||!u.user.id_club)return;m.value=!0,Q.value="";const a=`undefined/clubs/${u.user.id_club}`;try{const r=await fetch(a,{credentials:"include"}),de=await r.clone().text();if(!r.ok)throw new Error(`HTTP ${r.status}`);const ye=JSON.parse(de);if(!ye.club)throw new Error("Format de réponse incorrect");n.value=ye.club,await Promise.all([_e(),Me()])}catch(r){console.error("[loadUserClub] catch →",r),Q.value=r instanceof Error?r.message:String(r),n.value=null}finally{m.value=!1}}async function _e(){if(!n.value)return;m.value=!0,Q.value="";const a=`undefined/clubs/${n.value.id}/members`;try{const r=await fetch(a,{credentials:"include"}),de=await r.clone().text();if(!r.ok)throw new Error(`HTTP ${r.status}`);const ye=JSON.parse(de);i.value=(ye.users??[]).map(we=>({...we,id_grade:we.id_grade||null,is_active:typeof we.is_active=="boolean"?we.is_active:we.is_active===1||we.is_active==="true"}))}catch(r){console.error("[loadClubMembers] catch →",r),Q.value=r instanceof Error?r.message:String(r)}finally{m.value=!1}}async function Me(){try{const a=await fetch("undefined/grades",{credentials:"include"});if(!a.ok)throw new Error(`Erreur HTTP grades: ${a.status}`);const r=await a.json();if(!Array.isArray(r.grades)){console.error("Réponse grades inattendue:",r);return}_.value=r.grades.map(de=>({id:de.id,name:de.name}))}catch(v){console.error("Erreur lors du chargement des grades:",v)}}function Re(v){f.value={...v},j.value=!0}function Fe(v){Object.assign(w,{id:null,first_name:"",last_name:"",email:"",phone:"",birth_date:"",id_gender:1,weight:null,nationality:"Française",id_grade:null,id_role:3,is_active:!0}),Object.assign(w,{id:v.id,first_name:v.first_name||"",last_name:v.last_name||"",email:v.email||"",phone:v.phone||"",birth_date:v.birth_date?v.birth_date.split("T")[0]:"",id_gender:v.id_gender!==void 0?Number(v.id_gender):1,weight:v.weight!==void 0&&v.weight!==null?Number(v.weight):null,nationality:v.nationality||"Française",id_grade:v.id_grade!==void 0&&v.id_grade!==null?Number(v.id_grade):null,id_role:v.id_role!==void 0?Number(v.id_role):3,is_active:typeof v.is_active=="boolean"?v.is_active:!0}),A.value=!0}async function pe(){D.value=!0;try{if(!w.first_name||!w.last_name||!w.email){p.notify({color:"negative",message:"Veuillez remplir tous les champs obligatoires",icon:"warning"}),D.value=!1;return}if(!/^[^@]+@[^@]+\.[^@]+$/.test(w.email)){p.notify({color:"negative",message:"Format d'email invalide",icon:"warning"}),D.value=!1;return}const v={first_name:w.first_name,last_name:w.last_name,email:w.email,phone:w.phone===""?null:w.phone,birth_date:w.birth_date||void 0,id_gender:w.id_gender,weight:w.weight,nationality:w.nationality||"",id_grade:w.id_grade,id_role:w.id_role,is_active:w.is_active},r=await fetch(`undefined/users/${w.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(v)});if(!r.ok){const de=await r.json();throw new Error(de.error||`Erreur HTTP: ${r.status}`)}await _e(),p.notify({color:"positive",message:"Membre mis à jour avec succès",icon:"check_circle"}),A.value=!1}catch(v){console.error("Erreur lors de la sauvegarde:",v);let a="Erreur lors de la sauvegarde";v instanceof Error&&(v.message.includes("email")?a="Cet email est déjà utilisé par un autre compte":a=v.message),p.notify({color:"negative",message:a,icon:"error"})}finally{D.value=!1}}async function He(){await ke(),await Me()}return it(()=>{He()}),(v,a)=>(O(),ce(gl,{class:"q-pa-lg"},{default:l(()=>[a[54]||(a[54]=o("div",{class:"text-h4 q-mb-lg"},"Espace Manager",-1)),q.value?(O(),le("div",ka,[e(Ne,{size:"50px",color:"primary"}),a[19]||(a[19]=o("span",{class:"q-ml-md"},"Chargement des données...",-1))])):!gt(u).user||gt(u).user.id_role!==2?(O(),le("div",Pa,[e(rt,{class:"bg-negative text-white"},{avatar:l(()=>[e(X,{name:"error"})]),default:l(()=>[a[20]||(a[20]=x(" Accès restreint aux managers de club "))]),_:1}),a[21]||(a[21]=o("p",{class:"q-mt-md"},"Vous serez redirigé vers la page d'accueil dans quelques instants.",-1))])):(O(),le("div",Sa,[e(ql,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=r=>h.value=r),dense:"",class:"text-primary q-mb-md","active-color":"primary","indicator-color":"primary",align:"justify"},{default:l(()=>[e(lt,{name:"members",label:"Membres du club",icon:"people"}),e(lt,{name:"club-info",label:"Informations du club",icon:"business"}),e(lt,{name:"import",label:"Importation de données",icon:"upload_file"})]),_:1},8,["modelValue"]),e(_t),Q.value?(O(),ce(rt,{key:0,class:"bg-negative text-white q-my-md"},{avatar:l(()=>[e(X,{name:"error"})]),default:l(()=>[x(" "+k(Q.value),1)]),_:1})):ue("",!0),e(Dl,{modelValue:h.value,"onUpdate:modelValue":a[5]||(a[5]=r=>h.value=r),animated:""},{default:l(()=>[e(at,{name:"members"},{default:l(()=>[m.value?(O(),le("div",Va,[e(Ne,{size:"50px",color:"primary",class:"q-mb-md"}),a[22]||(a[22]=o("p",null,"Chargement des membres...",-1))])):n.value?(O(),le(Oe,{key:2},[o("div",Ia,[o("h2",Aa,"Membres de "+k(n.value.name),1),e(It),e(xe,{color:"primary","text-color":"white",class:"q-ml-sm"},{default:l(()=>[x(" Total : "+k(L.value.length),1)]),_:1}),e(xe,{color:"purple","text-color":"white"},{default:l(()=>[x(" Admins : "+k(G.value),1)]),_:1}),e(xe,{color:"blue","text-color":"white"},{default:l(()=>[x(" Managers : "+k(H.value),1)]),_:1}),e(xe,{color:"green","text-color":"white"},{default:l(()=>[x(" Joueurs : "+k(z.value),1)]),_:1})]),o("div",Da,[o("div",Ea,[e(re,{modelValue:P.value,"onUpdate:modelValue":a[1]||(a[1]=r=>P.value=r),outlined:"",dense:"",label:"Rechercher par nom",clearable:""},{append:l(()=>[e(X,{name:"search"})]),_:1},8,["modelValue"])]),o("div",Ma,[e(Te,{modelValue:U.value,"onUpdate:modelValue":a[2]||(a[2]=r=>U.value=r),options:s.value,outlined:"",dense:"",label:"Rôle","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"])]),o("div",Fa,[e(Te,{modelValue:M.value,"onUpdate:modelValue":a[3]||(a[3]=r=>M.value=r),options:b,outlined:"",dense:"",label:"Statut","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])]),o("div",La,[e(Te,{modelValue:F.value,"onUpdate:modelValue":a[4]||(a[4]=r=>F.value=r),options:y.value,outlined:"",dense:"",label:"Grade","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"])])]),e(Be,{rows:L.value,columns:c,"row-key":"id",loading:m.value,bordered:"",flat:"","pagination-label":te,"rows-per-page-options":[10,15,20,0]},{body:l(r=>[e(pl,{props:r,class:Vt(r.row.is_active?"":"bg-grey-2")},{default:l(()=>[e(fe,{key:"id",props:r},{default:l(()=>[x(k(r.row.id),1)]),_:2},1032,["props"]),e(fe,{key:"name",props:r},{default:l(()=>[o("div",Na,[e(ot,{size:"28px",class:"q-mr-sm"},{default:l(()=>[r.row.avatar_seed?(O(),ce(wt,{key:0,src:E(r.row.avatar_seed)},null,8,["src"])):(O(),ce(X,{key:1,name:"person",size:"28px",color:"grey-7"}))]),_:2},1024),x(" "+k(r.row.first_name)+" "+k(r.row.last_name),1)])]),_:2},1032,["props"]),e(fe,{key:"email",props:r},{default:l(()=>[x(k(r.row.email),1)]),_:2},1032,["props"]),e(fe,{key:"info",props:r},{default:l(()=>[o("div",Ra,[e(xe,{dense:"",outline:"",size:"sm",icon:"event"},{default:l(()=>[x(k(ee(r.row.birth_date)),1)]),_:2},1024),r.row.weight?(O(),ce(xe,{key:0,dense:"",outline:"",size:"sm",icon:"fitness_center"},{default:l(()=>[x(k(r.row.weight)+" kg ",1)]),_:2},1024)):ue("",!0),e(xe,{dense:"",size:"sm",icon:"flag"},{default:l(()=>[x(k(r.row.nationality),1)]),_:2},1024)])]),_:2},1032,["props"]),e(fe,{key:"role",props:r},{default:l(()=>[e(ge,{color:C(r.row.id_role)},{default:l(()=>[x(k(R.value(r.row.id_role)),1)]),_:2},1032,["color"])]),_:2},1032,["props"]),e(fe,{key:"grade",props:r},{default:l(()=>[e(ge,{color:"orange"},{default:l(()=>[x(k(r.row.grade_name||I.value(r.row.id_grade)||"—"),1)]),_:2},1024)]),_:2},1032,["props"]),e(fe,{key:"status",props:r},{default:l(()=>[e(ge,{color:r.row.is_active?"positive":"negative"},{default:l(()=>[x(k(r.row.is_active?"Actif":"Inactif"),1)]),_:2},1032,["color"])]),_:2},1032,["props"]),e(fe,{key:"actions",props:r,class:"q-gutter-sm"},{default:l(()=>[o("div",Ua,[e(ae,{flat:"",dense:"",round:"",icon:"visibility",color:"primary",onClick:de=>Re(r.row)},{default:l(()=>[e(De,null,{default:l(()=>a[25]||(a[25]=[x("Voir détails")])),_:1})]),_:2},1032,["onClick"]),e(ae,{flat:"",dense:"",round:"",icon:"edit",color:"info",onClick:de=>Fe(r.row)},{default:l(()=>[e(De,null,{default:l(()=>a[26]||(a[26]=[x("Modifier")])),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props","class"])]),"no-data":l(()=>[o("div",ja,[e(X,{size:"2em",name:"sentiment_dissatisfied"}),a[27]||(a[27]=o("span",null,"Aucun membre trouvé",-1))])]),_:1},8,["rows","loading"])],64)):(O(),le("div",$a,[e(X,{name:"error_outline",size:"50px",color:"negative",class:"q-mb-md"}),a[23]||(a[23]=o("p",{class:"text-h6"},"Vous n'êtes pas associé à un club",-1)),a[24]||(a[24]=o("p",null,"Contactez un administrateur pour vous assigner à un club.",-1))]))]),_:1}),e(at,{name:"club-info"},{default:l(()=>[m.value?(O(),le("div",za,[e(Ne,{size:"50px",color:"primary",class:"q-mb-md"}),a[28]||(a[28]=o("p",null,"Chargement des informations du club...",-1))])):n.value?(O(),le(Oe,{key:2},[a[31]||(a[31]=o("h2",{class:"text-h5"},"Informations du club",-1)),o("div",Qa,[e(aa,{club:n.value,onClubUpdated:ve},null,8,["club"])])],64)):(O(),le("div",Oa,[e(X,{name:"error_outline",size:"50px",color:"negative",class:"q-mb-md"}),a[29]||(a[29]=o("p",{class:"text-h6"},"Vous n'êtes pas associé à un club",-1)),a[30]||(a[30]=o("p",null,"Contactez un administrateur pour vous assigner à un club.",-1))]))]),_:1}),e(at,{name:"import"},{default:l(()=>[a[32]||(a[32]=o("h2",{class:"text-h5"},"Gestion des tournois",-1)),o("div",Ba,[e(qa,{"club-id":n.value?.id||0},null,8,["club-id"])]),a[33]||(a[33]=o("h2",{class:"text-h5"},"Importation de données",-1)),o("div",Ga,[e(ga,{"club-id":n.value?.id??null},null,8,["club-id"])])]),_:1})]),_:1},8,["modelValue"])])),e(Qe,{modelValue:j.value,"onUpdate:modelValue":a[7]||(a[7]=r=>j.value=r)},{default:l(()=>[e(be,{style:{"min-width":"350px","max-width":"80vw"}},{default:l(()=>[e(me,{class:"bg-primary text-white"},{default:l(()=>[a[34]||(a[34]=o("div",{class:"text-h6"},"Détails du membre",-1)),qe(e(ae,{icon:"close",flat:"",round:"",dense:"",class:"absolute-right"},null,512),[[Se]])]),_:1}),f.value?(O(),ce(me,{key:0},{default:l(()=>[o("div",Ja,[e(ot,{size:"80px"},{default:l(()=>[e(wt,{src:E(f.value.avatar_seed||"default")},null,8,["src"])]),_:1})]),e(bl,{bordered:"",separator:""},{default:l(()=>[e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[35]||(a[35]=[x("ID")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.id),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[36]||(a[36]=[x("Nom complet")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.first_name)+" "+k(f.value.last_name),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[37]||(a[37]=[x("Email")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.email),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[38]||(a[38]=[x("Téléphone")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.phone||"—"),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[39]||(a[39]=[x("Date de naissance")])),_:1}),e(K,null,{default:l(()=>[x(k(ee(f.value.birth_date)),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[40]||(a[40]=[x("Genre")])),_:1}),e(K,null,{default:l(()=>[x(k(d.find(r=>r.value===f.value?.id_gender)?.label||"—"),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[41]||(a[41]=[x("Poids")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.weight?f.value.weight+" kg":"—"),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[42]||(a[42]=[x("Nationalité")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.nationality||"—"),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[43]||(a[43]=[x("Rôle")])),_:1}),e(K,null,{default:l(()=>[e(ge,{color:C(f.value.id_role)},{default:l(()=>[x(k(R.value(f.value.id_role)),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[44]||(a[44]=[x("Club")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.club_name||"—"),1)]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[45]||(a[45]=[x("Grade")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.grade_name||I.value(f.value.id_grade)||"—"),1)]),_:1})]),_:1})]),_:1}),f.value.tournament_name?(O(),ce(ne,{key:0},{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[46]||(a[46]=[x("Tournoi en attente")])),_:1}),e(K,null,{default:l(()=>[x(k(f.value.tournament_name),1)]),_:1})]),_:1})]),_:1})):ue("",!0),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[47]||(a[47]=[x("Statut")])),_:1}),e(K,null,{default:l(()=>[e(ge,{color:f.value.is_active?"positive":"negative"},{default:l(()=>[x(k(f.value.is_active?"Actif":"Inactif"),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),e(ne,null,{default:l(()=>[e(oe,null,{default:l(()=>[e(K,{caption:""},{default:l(()=>a[48]||(a[48]=[x("Date de création")])),_:1}),e(K,null,{default:l(()=>[x(k(ie(f.value.created_at)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):ue("",!0),e(st,{align:"right"},{default:l(()=>[qe(e(ae,{flat:"",label:"Fermer",color:"primary"},null,512),[[Se]]),e(ae,{flat:"",label:"Modifier",color:"secondary",onClick:a[6]||(a[6]=r=>{f.value&&Fe(f.value),j.value=!1})})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Qe,{modelValue:A.value,"onUpdate:modelValue":a[18]||(a[18]=r=>A.value=r)},{default:l(()=>[e(be,{style:{width:"700px","max-width":"90vw"}},{default:l(()=>[e(me,{class:"bg-primary text-white"},{default:l(()=>[a[49]||(a[49]=o("div",{class:"text-h6"},"Modifier les informations du membre",-1)),qe(e(ae,{icon:"close",flat:"",round:"",dense:"",class:"absolute-right"},null,512),[[Se]])]),_:1}),e(me,{class:"q-pa-md"},{default:l(()=>[e(At,{onSubmit:$t(pe,["prevent"]),class:"q-gutter-md"},{default:l(()=>[o("div",Ha,[a[51]||(a[51]=o("div",{class:"text-subtitle1 q-mb-sm"},"Informations personnelles",-1)),o("div",Ka,[o("div",Wa,[e(re,{modelValue:w.first_name,"onUpdate:modelValue":a[8]||(a[8]=r=>w.first_name=r),label:"Prénom *",outlined:"",dense:"",rules:[r=>!!r||"Le prénom est requis"]},null,8,["modelValue","rules"])]),o("div",Xa,[e(re,{modelValue:w.last_name,"onUpdate:modelValue":a[9]||(a[9]=r=>w.last_name=r),label:"Nom *",outlined:"",dense:"",rules:[r=>!!r||"Le nom est requis"]},null,8,["modelValue","rules"])])]),o("div",Ya,[o("div",Za,[e(re,{modelValue:w.email,"onUpdate:modelValue":a[10]||(a[10]=r=>w.email=r),label:"Email *",type:"email",outlined:"",dense:"",rules:[r=>!!r||"L'email est requis",r=>/^[^@]+@[^@]+\.[^@]+$/.test(r)||"Format d'email invalide"]},null,8,["modelValue","rules"])]),o("div",en,[e(re,{modelValue:w.phone,"onUpdate:modelValue":a[11]||(a[11]=r=>w.phone=r),label:"Téléphone",outlined:"",dense:""},null,8,["modelValue"])])]),o("div",tn,[o("div",ln,[e(re,{modelValue:w.birth_date,"onUpdate:modelValue":a[12]||(a[12]=r=>w.birth_date=r),label:"Date de naissance",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),o("div",an,[e(Te,{modelValue:w.id_gender,"onUpdate:modelValue":a[13]||(a[13]=r=>w.id_gender=r),options:d,label:"Genre *",outlined:"",dense:"","emit-value":"","map-options":"","menu-self":"top middle","menu-anchor":"bottom middle"},{"no-option":l(()=>[e(ne,null,{default:l(()=>[e(oe,{class:"text-grey"},{default:l(()=>a[50]||(a[50]=[x(" Aucun genre disponible ")])),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),e(_t,{spaced:""}),o("div",nn,[a[53]||(a[53]=o("div",{class:"text-subtitle1 q-mb-sm"},"Informations sportives",-1)),o("div",on,[o("div",rn,[e(re,{modelValue:w.weight,"onUpdate:modelValue":a[14]||(a[14]=r=>w.weight=r),modelModifiers:{number:!0},label:"Poids (kg)",type:"number",outlined:"",dense:"",min:"30",max:"200"},null,8,["modelValue"])]),o("div",sn,[e(re,{modelValue:w.nationality,"onUpdate:modelValue":a[15]||(a[15]=r=>w.nationality=r),label:"Nationalité",outlined:"",dense:""},null,8,["modelValue"])])]),o("div",un,[o("div",dn,[e(Te,{modelValue:w.id_grade,"onUpdate:modelValue":a[16]||(a[16]=r=>w.id_grade=r),options:y.value,label:"Grade",outlined:"",dense:"","emit-value":"","map-options":"",clearable:"","menu-self":"top middle","menu-anchor":"bottom middle"},{"no-option":l(()=>[e(ne,null,{default:l(()=>[e(oe,{class:"text-grey"},{default:l(()=>a[52]||(a[52]=[x(" Aucun grade disponible ")])),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),o("div",cn,[e(Te,{modelValue:w.id_role,"onUpdate:modelValue":a[17]||(a[17]=r=>w.id_role=r),options:s.value,label:"Rôle",outlined:"",dense:"","emit-value":"","map-options":"","menu-self":"top middle","menu-anchor":"bottom middle"},{"selected-item":l(({opt:r})=>[e(ge,{color:C(r.value)},{default:l(()=>[x(k(r.label),1)]),_:2},1032,["color"])]),_:1},8,["modelValue","options"])])])]),o("div",mn,[qe(e(ae,{flat:"",label:"Annuler",color:"grey-7",class:"q-mr-sm"},null,512),[[Se]]),e(ae,{unelevated:"",type:"submit",label:"Enregistrer",color:"primary",loading:D.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{$n as default};
